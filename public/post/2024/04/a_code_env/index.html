<!doctype html><html class="not-ready lg:text-base close" style=--bg:#faf8f1 lang=zh-CN dir=ltr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>创建一个远程编译环境 - caoyang2002</title>
<meta name=theme-color><meta name=description content="
我使用的是 Mac，所以以下都是 Mac 的说明

一、前端（ts、react）

前端配置：TypeScript、React
依赖项：axios、codemirror、react-codemirror2

1. 初始化模板

任意选一个就行

1.1 交互式
npm init vite

可能需要先安装
npm install vite --save-dev

caoyang@cccy del % npm init vite
# 使用 上下键 选择
✔ Project name: … playground  # playground 是项目名称，它会创建一个该名称的文件夹作为项目根目录
✔ Select a framework: › React  # 使用 React 库
✔ Select a variant: › TypeScript  # 使用 TS 语言开发

Scaffolding project in /Users/caoyang/Documents/Aptos/del/playground...

Done. Now run:

# 需要先运行以下代码
  cd playground
  npm install
  npm run dev
1.2 一键创建
npm init vite playground -- --template react-ts
或者"><meta name=author content="Cyrus"><link rel="preload stylesheet" as=style href=https://caoyang2002.xyz/main.min.css><link rel=preload as=image href=https://caoyang2002.xyz/theme.png><link rel=preload as=image href=/about/avatar.jpg><link rel=preload as=image href=https://caoyang2002.xyz/twitter.svg><link rel=preload as=image href=https://caoyang2002.xyz/github.svg><link rel=preload as=image href=https://caoyang2002.xyz/instagram.svg><link rel=preload as=image href=https://caoyang2002.xyz/rss.svg><script defer src=https://caoyang2002.xyz/highlight.min.js onload=hljs.initHighlightingOnLoad()></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css integrity=sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js integrity=sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",()=>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1}))</script><link rel=icon href=https://caoyang2002.xyz/favicon.ico><link rel=apple-touch-icon href=https://caoyang2002.xyz/apple-touch-icon.png><meta name=generator content="Hugo 0.140.2"><meta itemprop=name content="创建一个远程编译环境"><meta itemprop=description content="我使用的是 Mac，所以以下都是 Mac 的说明
一、前端（ts、react） 前端配置：TypeScript、React 依赖项：axios、codemirror、react-codemirror2
1. 初始化模板 任意选一个就行
1.1 交互式 npm init vite 可能需要先安装 npm install vite --save-dev
caoyang@cccy del % npm init vite # 使用 上下键 选择 ✔ Project name: … playground # playground 是项目名称，它会创建一个该名称的文件夹作为项目根目录 ✔ Select a framework: › React # 使用 React 库 ✔ Select a variant: › TypeScript # 使用 TS 语言开发 Scaffolding project in /Users/caoyang/Documents/Aptos/del/playground... Done. Now run: # 需要先运行以下代码 cd playground npm install npm run dev 1.2 一键创建 npm init vite playground -- --template react-ts 或者"><meta itemprop=datePublished content="2024-04-29T09:31:37+08:00"><meta itemprop=dateModified content="2025-01-05T10:56:18+08:00"><meta itemprop=wordCount content="3868"><meta property="og:url" content="https://caoyang2002.xyz/post/2024/04/a_code_env/"><meta property="og:site_name" content="caoyang2002"><meta property="og:title" content="创建一个远程编译环境"><meta property="og:description" content="我使用的是 Mac，所以以下都是 Mac 的说明
一、前端（ts、react） 前端配置：TypeScript、React 依赖项：axios、codemirror、react-codemirror2
1. 初始化模板 任意选一个就行
1.1 交互式 npm init vite 可能需要先安装 npm install vite --save-dev
caoyang@cccy del % npm init vite # 使用 上下键 选择 ✔ Project name: … playground # playground 是项目名称，它会创建一个该名称的文件夹作为项目根目录 ✔ Select a framework: › React # 使用 React 库 ✔ Select a variant: › TypeScript # 使用 TS 语言开发 Scaffolding project in /Users/caoyang/Documents/Aptos/del/playground... Done. Now run: # 需要先运行以下代码 cd playground npm install npm run dev 1.2 一键创建 npm init vite playground -- --template react-ts 或者"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-29T09:31:37+08:00"><meta property="article:modified_time" content="2025-01-05T10:56:18+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="创建一个远程编译环境"><meta name=twitter:description content="我使用的是 Mac，所以以下都是 Mac 的说明
一、前端（ts、react） 前端配置：TypeScript、React 依赖项：axios、codemirror、react-codemirror2
1. 初始化模板 任意选一个就行
1.1 交互式 npm init vite 可能需要先安装 npm install vite --save-dev
caoyang@cccy del % npm init vite # 使用 上下键 选择 ✔ Project name: … playground # playground 是项目名称，它会创建一个该名称的文件夹作为项目根目录 ✔ Select a framework: › React # 使用 React 库 ✔ Select a variant: › TypeScript # 使用 TS 语言开发 Scaffolding project in /Users/caoyang/Documents/Aptos/del/playground... Done. Now run: # 需要先运行以下代码 cd playground npm install npm run dev 1.2 一键创建 npm init vite playground -- --template react-ts 或者"><link rel=canonical href=https://caoyang2002.xyz/post/2024/04/a_code_env/></head><body class="text-black duration-200 ease-out dark:text-white"><header class="mx-auto flex h-[4.5rem] px-8 lg:justify-center"><div class="relative z-50 ltr:mr-auto rtl:ml-auto flex items-center max-w-[--w]"><a class="-translate-y-[1px] text-2xl font-medium" href=https://caoyang2002.xyz/>caoyang2002</a><div class="btn-dark text-[0] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 ltr:-mr-8 rtl:-ml-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.contains("open")?(htmlClass.remove("open"),htmlClass.add("close")):(htmlClass.remove("close"),htmlClass.add("open"))});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg="#faf8f1".replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"#000":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"><nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse"><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/>首页</a>
<a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/about/>关于</a>
<a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/contact/>联系</a>
<a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/guestbook/>留言</a></nav><nav class="mt-12 flex justify-center space-x-10 rtl:space-x-reverse dark:invert ltr:lg:ml-14 rtl:lg:mr-14 lg:mt-0 lg:items-center"><a class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./twitter.svg) href=https://twitter.com/caoyang2002 target=_blank rel=me>twitter
</a><a class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./github.svg) href=https://github.com/caoyang2002 target=_blank rel=me>github
</a><a class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./instagram.svg) href=https://instagram.com/caoyang2002 target=_blank rel=me>instagram
</a><a class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./rss.svg) href=https://caoyang2002.xyz/index.xml target=_blank rel=alternate>rss</a></nav></div></header><style>header{position:fixed;top:0;left:0;right:0;z-index:50;width:100vw;text-align:center;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);background:rgba(255,255,255,.5);box-shadow:0 4px 30px rgba(0,0,0,.1)}</style><div class="relative flex justify-start max-w-[90vw] px-8"><main class="prose prose-neutral flex-1 min-h-[calc(100vh-9rem)] pt-14 pb-16 dark:prose-invert text-left"><article class=text-left><div class="mb-14 mt-8"><h1 class="!my-0 pb-2.5">创建一个远程编译环境</h1><div class="text-xs antialiased opacity-60"><time>2024年4月29日</time></div></div><section><blockquote><p>我使用的是 Mac，所以以下都是 Mac 的说明</p></blockquote><h1 id=一前端tsreact>一、前端（ts、react）</h1><blockquote><p>前端配置：TypeScript、React
依赖项：axios、codemirror、react-codemirror2</p></blockquote><h2 id=1-初始化模板>1. 初始化模板</h2><blockquote><p>任意选一个就行</p></blockquote><h3 id=11-交互式>1.1 交互式</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm init vite
</span></span></code></pre></div><blockquote><p>可能需要先安装
<code>npm install vite --save-dev</code></p></blockquote><pre tabindex=0><code>caoyang@cccy del % npm init vite
# 使用 上下键 选择
✔ Project name: … playground  # playground 是项目名称，它会创建一个该名称的文件夹作为项目根目录
✔ Select a framework: › React  # 使用 React 库
✔ Select a variant: › TypeScript  # 使用 TS 语言开发

Scaffolding project in /Users/caoyang/Documents/Aptos/del/playground...

Done. Now run:

# 需要先运行以下代码
  cd playground
  npm install
  npm run dev
</code></pre><h3 id=12-一键创建>1.2 一键创建</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm init vite playground -- --template react-ts
</span></span></code></pre></div><p>或者</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npx create-vite playground --template react-ts
</span></span></code></pre></div><p>或者</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm init @vitejs/app playground -- --template react-ts
</span></span></code></pre></div><p>{bs-accord style=line title=解析}
<code>npm init vite</code> : 是一个 npm 初始化命令，它使用了 Vite 工具，
<code>my-react-ts-app</code> : 是您希望创建的项目的名称。
<code>--</code> : 是用来分隔 npm 命令行选项和参数的，
<code>--template react-ts</code> : 是向 Vite 提供的选项，它告诉 Vite 使用 React TypeScript 模板来生成项目。
{/bs-accord}</p><h2 id=2-安装并运行模板>2. 安装并运行模板</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 需要先运行以下代码</span>
</span></span><span style=display:flex><span>  cd playground
</span></span><span style=display:flex><span>  npm install
</span></span><span style=display:flex><span>  npm run dev
</span></span></code></pre></div><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>caoyang@cccy playground %   npm install
</span></span><span style=display:flex><span>added <span style=color:#ae81ff>218</span> packages, and audited <span style=color:#ae81ff>219</span> packages in 59s
</span></span><span style=display:flex><span><span style=color:#ae81ff>41</span> packages are looking <span style=color:#66d9ef>for</span> funding
</span></span><span style=display:flex><span> run <span style=color:#e6db74>`</span>npm fund<span style=color:#e6db74>`</span> <span style=color:#66d9ef>for</span> details
</span></span><span style=display:flex><span>found <span style=color:#ae81ff>0</span> vulnerabilities
</span></span></code></pre></div></blockquote><blockquote><p>在 vscode 中打开，并编辑</p></blockquote><h2 id=3-删除不需要的文件>3. 删除不需要的文件</h2><p>建议删除，否则可能出现非预期的情况</p><ul><li><code>public / vite.svg</code></li><li><code>src / App.css</code></li><li><code>src / index.css</code></li><li>删除 <code>App.tsx</code> 和 <code>main.tsx</code> 中的导入</li></ul><h2 id=4-创建-playgroundtsx-组件>4. 创建 <code>playground.tsx</code> 组件</h2><blockquote><p>安装依赖项</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm install axios codemirror react-codemirror2
</span></span><span style=display:flex><span><span style=color:#75715e># 或者</span>
</span></span><span style=display:flex><span>npm install axios codemirror react-codemirror2 --legacy-peer-deps
</span></span><span style=display:flex><span><span style=color:#75715e># 或者</span>
</span></span><span style=display:flex><span>npm install axios@1.6.8 codemirror@5.65.16 react@18.2.0 react-codemirror2@7.3.0 react-dom@18.2.0
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span>, { <span style=color:#a6e22e>useState</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Controlled</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>CodeMirror</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react-codemirror2&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>axios</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;axios&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#39;codemirror/lib/codemirror.css&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#39;codemirror/theme/material.css&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#39;./move.js&#39;</span>; <span style=color:#75715e>// 导入 move.js 文件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Playground</span>: <span style=color:#66d9ef>React.FC</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>code</span>, <span style=color:#a6e22e>setCode</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#e6db74>&#39;&#39;</span>);
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>output</span>, <span style=color:#a6e22e>setOutput</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#e6db74>&#39;&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleCodeChange</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>editor</span>: <span style=color:#66d9ef>any</span>, <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>any</span>, <span style=color:#a6e22e>value</span>: <span style=color:#66d9ef>string</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>setCode</span>(<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>	};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>executeCode</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>			<span style=color:#75715e>// 发送 Move 代码到后端服务
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>post</span>(<span style=color:#e6db74>&#39;http://127.0.0.1:8081/run_move&#39;</span>, <span style=color:#a6e22e>code</span>);
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>setOutput</span>(<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>		} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;执行 Move 代码时出错:&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>		&lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>			&lt;<span style=color:#f92672>CodeMirror</span>
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>value</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>code</span>}
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>options</span><span style=color:#f92672>=</span>{{
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;move&#39;</span>, <span style=color:#75715e>// 使用 move 模式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>					<span style=color:#a6e22e>theme</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;material&#39;</span>,
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>lineNumbers</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>				}}
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>onBeforeChange</span><span style=color:#f92672>=</span>{(<span style=color:#a6e22e>editor</span>, <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>setCode</span>(<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>				}}
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleCodeChange</span>}
</span></span><span style=display:flex><span>			/&gt;
</span></span><span style=display:flex><span>			&lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>executeCode</span>}&gt;<span style=color:#960050;background-color:#1e0010>执行</span>&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>			&lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>				&lt;<span style=color:#f92672>h3</span>&gt;<span style=color:#960050;background-color:#1e0010>执行结果</span><span style=color:#f92672>:</span>&lt;/<span style=color:#f92672>h3</span>&gt;
</span></span><span style=display:flex><span>				&lt;<span style=color:#f92672>pre</span>&gt;{<span style=color:#a6e22e>output</span>}&lt;/<span style=color:#f92672>pre</span>&gt;
</span></span><span style=display:flex><span>			&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>		&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>	);
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>Playground</span>;
</span></span></code></pre></div><h2 id=5-修改maintsx>5. 修改<code>main.tsx</code></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>ReactDOM</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react-dom/client&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>App</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./App.tsx&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ReactDOM</span>.<span style=color:#a6e22e>createRoot</span>(document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;root&#39;</span>)<span style=color:#f92672>!</span>).<span style=color:#a6e22e>render</span>(
</span></span><span style=display:flex><span>  <span style=color:#75715e>// &lt;React.StrictMode&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  &lt;<span style=color:#f92672>App</span> /&gt;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// &lt;/React.StrictMode&gt;,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>)
</span></span></code></pre></div><h2 id=6-修改apptsx>6. 修改<code>App.tsx</code></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tsx data-lang=tsx><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useState</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Playground</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./playground&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>App() {</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>count</span>, <span style=color:#a6e22e>setCount</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (
</span></span><span style=display:flex><span>    &lt;&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>Playground</span> /&gt;
</span></span><span style=display:flex><span>    &lt;/&gt;
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>App</span>
</span></span></code></pre></div><h2 id=7-创建语法高亮-movejs>7. 创建语法高亮 <code>move.js</code></h2><blockquote><p>这部分没有完全适配，只是一个 rust 模板。</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>CodeMirror</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;codemirror&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>CodeMirror</span>.<span style=color:#a6e22e>defineMode</span>(<span style=color:#e6db74>&#34;move&#34;</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>config</span>, <span style=color:#a6e22e>parserConfig</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>indentUnit</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>indentUnit</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>statementIndentUnit</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parserConfig</span>.<span style=color:#a6e22e>statementIndentUnit</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>indentUnit</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>dontAlignCalls</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parserConfig</span>.<span style=color:#a6e22e>dontAlignCalls</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>keywords</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parserConfig</span>.<span style=color:#a6e22e>keywords</span> <span style=color:#f92672>||</span> {},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>builtin</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parserConfig</span>.<span style=color:#a6e22e>builtin</span> <span style=color:#f92672>||</span> {},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>blockKeywords</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parserConfig</span>.<span style=color:#a6e22e>blockKeywords</span> <span style=color:#f92672>||</span> {},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>atoms</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parserConfig</span>.<span style=color:#a6e22e>atoms</span> <span style=color:#f92672>||</span> {},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>hooks</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parserConfig</span>.<span style=color:#a6e22e>hooks</span> <span style=color:#f92672>||</span> {},
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>multiLineStrings</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parserConfig</span>.<span style=color:#a6e22e>multiLineStrings</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>isOperatorChar</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/[+\-*&amp;%=&lt;&gt;!?|\/]/</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>curPunc</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>tokenBase</span>(<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ch</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>next</span>();
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>hooks</span>[<span style=color:#a6e22e>ch</span>]) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>hooks</span>[<span style=color:#a6e22e>ch</span>](<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>result</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>false</span>) <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ch</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#34;&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>ch</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#39;&#34;</span>) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tokenString</span>(<span style=color:#a6e22e>ch</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span>(<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#e6db74>/[\[\]{}\(\),;\:\.]/</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>ch</span>)) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ch</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#e6db74>/\d/</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>ch</span>)) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>eatWhile</span>(<span style=color:#e6db74>/[\w\.]/</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;number&#34;</span>;
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ch</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;/&#34;</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>eat</span>(<span style=color:#e6db74>&#34;*&#34;</span>)) {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tokenComment</span>;
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>tokenComment</span>(<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>);
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>eat</span>(<span style=color:#e6db74>&#34;/&#34;</span>)) {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>skipToEnd</span>();
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;comment&#34;</span>;
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isOperatorChar</span>.<span style=color:#a6e22e>test</span>(<span style=color:#a6e22e>ch</span>)) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>eatWhile</span>(<span style=color:#a6e22e>isOperatorChar</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;operator&#34;</span>;
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>eatWhile</span>(<span style=color:#e6db74>/[\w\$_]/</span>);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>cur</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>current</span>();
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>keywords</span>.<span style=color:#a6e22e>propertyIsEnumerable</span>(<span style=color:#a6e22e>cur</span>)) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blockKeywords</span>.<span style=color:#a6e22e>propertyIsEnumerable</span>(<span style=color:#a6e22e>cur</span>)) <span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;newstatement&#34;</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;keyword&#34;</span>;
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>builtin</span>.<span style=color:#a6e22e>propertyIsEnumerable</span>(<span style=color:#a6e22e>cur</span>)) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blockKeywords</span>.<span style=color:#a6e22e>propertyIsEnumerable</span>(<span style=color:#a6e22e>cur</span>)) <span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;newstatement&#34;</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;builtin&#34;</span>;
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>atoms</span>.<span style=color:#a6e22e>propertyIsEnumerable</span>(<span style=color:#a6e22e>cur</span>)) <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;atom&#34;</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;variable&#34;</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>tokenString</span>(<span style=color:#a6e22e>quote</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>escaped</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>, <span style=color:#a6e22e>next</span>, <span style=color:#a6e22e>end</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>while</span> ((<span style=color:#a6e22e>next</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>next</span>()) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>next</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>quote</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>escaped</span>) { <span style=color:#a6e22e>end</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#66d9ef>break</span>; }
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>escaped</span> <span style=color:#f92672>=</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>escaped</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>next</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;\\&#34;</span>;
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>end</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span>(<span style=color:#a6e22e>escaped</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>multiLineStrings</span>))
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;string&#34;</span>;
</span></span><span style=display:flex><span>		};
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>tokenComment</span>(<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>maybeEnd</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>, <span style=color:#a6e22e>ch</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>ch</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>next</span>()) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ch</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;/&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>maybeEnd</span>) {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>maybeEnd</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>ch</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;*&#34;</span>);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;comment&#34;</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Context</span>(<span style=color:#a6e22e>indented</span>, <span style=color:#a6e22e>column</span>, <span style=color:#a6e22e>type</span>, <span style=color:#a6e22e>align</span>, <span style=color:#a6e22e>prev</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>indented</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>indented</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>column</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>column</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>type</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>align</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>align</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prev</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>prev</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>pushContext</span>(<span style=color:#a6e22e>state</span>, <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>type</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>indent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>indented</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;statement&#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>indent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>indented</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Context</span>(<span style=color:#a6e22e>indent</span>, <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>type</span>, <span style=color:#66d9ef>null</span>, <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span>);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>popContext</span>(<span style=color:#a6e22e>state</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>type</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>t</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;)&#34;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;]&#34;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;}&#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>indented</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>indented</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>prev</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Interface
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>startState</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>basecolumn</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>tokenize</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span>,
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>context</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Context</span>((<span style=color:#a6e22e>basecolumn</span> <span style=color:#f92672>||</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>-</span> <span style=color:#a6e22e>indentUnit</span>, <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#34;top&#34;</span>, <span style=color:#66d9ef>false</span>),
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>indented</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>startOfLine</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>			};
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>token</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>sol</span>()) {
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>align</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>align</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>indented</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>indentation</span>();
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>startOfLine</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>eatSpace</span>()) <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>style</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>tokenBase</span>)(<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>style</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;comment&#34;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>style</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;meta&#34;</span>) <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>style</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>align</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>align</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> ((<span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;;&#34;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;:&#34;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;,&#34;</span>) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;statement&#34;</span>) <span style=color:#a6e22e>popContext</span>(<span style=color:#a6e22e>state</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;{&#34;</span>) <span style=color:#a6e22e>pushContext</span>(<span style=color:#a6e22e>state</span>, <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>column</span>(), <span style=color:#e6db74>&#34;}&#34;</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;[&#34;</span>) <span style=color:#a6e22e>pushContext</span>(<span style=color:#a6e22e>state</span>, <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>column</span>(), <span style=color:#e6db74>&#34;]&#34;</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;(&#34;</span>) <span style=color:#a6e22e>pushContext</span>(<span style=color:#a6e22e>state</span>, <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>column</span>(), <span style=color:#e6db74>&#34;)&#34;</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;}&#34;</span>) {
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;statement&#34;</span>) <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>popContext</span>(<span style=color:#a6e22e>state</span>);
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;}&#34;</span>) <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>popContext</span>(<span style=color:#a6e22e>state</span>);
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;statement&#34;</span>) <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>popContext</span>(<span style=color:#a6e22e>state</span>);
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span>) <span style=color:#a6e22e>popContext</span>(<span style=color:#a6e22e>state</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (((<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;}&#34;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;top&#34;</span>) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;;&#39;</span>) <span style=color:#f92672>||</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;statement&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>curPunc</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;newstatement&#34;</span>))
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>pushContext</span>(<span style=color:#a6e22e>state</span>, <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>column</span>(), <span style=color:#e6db74>&#34;statement&#34;</span>);
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>startOfLine</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>style</span>;
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>indent</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>state</span>, <span style=color:#a6e22e>textAfter</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>!=</span> <span style=color:#a6e22e>tokenBase</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>CodeMirror</span>.<span style=color:#a6e22e>Pass</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>context</span>, <span style=color:#a6e22e>firstChar</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>textAfter</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>textAfter</span>.<span style=color:#a6e22e>charAt</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;statement&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>firstChar</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;}&#34;</span>) <span style=color:#a6e22e>ctx</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>prev</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>closing</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>firstChar</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;statement&#34;</span>) <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>indented</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>firstChar</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;{&#34;</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>statementIndentUnit</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>align</span> <span style=color:#f92672>&amp;&amp;</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>dontAlignCalls</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;)&#34;</span>)) <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>column</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>closing</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;)&#34;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>closing</span>) <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>indented</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>statementIndentUnit</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ctx</span>.<span style=color:#a6e22e>indented</span> <span style=color:#f92672>+</span> (<span style=color:#a6e22e>closing</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>indentUnit</span>);
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>electricChars</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;{}&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>blockCommentStart</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;/*&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>blockCommentEnd</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;*/&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>lineComment</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;//&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>fold</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;brace&#34;</span>
</span></span><span style=display:flex><span>	};
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(<span style=color:#66d9ef>function</span> () {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>words</span>(<span style=color:#a6e22e>str</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>obj</span> <span style=color:#f92672>=</span> {}, <span style=color:#a6e22e>words</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>str</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>words</span>.<span style=color:#a6e22e>length</span>; <span style=color:#f92672>++</span><span style=color:#a6e22e>i</span>) <span style=color:#a6e22e>obj</span>[<span style=color:#a6e22e>words</span>[<span style=color:#a6e22e>i</span>]] <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>obj</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>rustKeywords</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;abstract async await become box break const continue crate do dyn else enum extern false fn for if impl in let loop macro match mod move mut pub ref return self Self static struct super trait true type union unsafe use where while yield&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>rustHook</span>(<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>startOfLine</span>) <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> (; ;) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>skipTo</span>(<span style=color:#e6db74>&#34;\\&#34;</span>)) {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>next</span>();
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>eol</span>()) {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rustHook</span>;
</span></span><span style=display:flex><span>					<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>				}
</span></span><span style=display:flex><span>			} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>skipToEnd</span>();
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;meta&#34;</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Rust-style strings where &#34;&#34; escapes a quote.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>tokenAtString</span>(<span style=color:#a6e22e>stream</span>, <span style=color:#a6e22e>state</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>next</span>;
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>while</span> ((<span style=color:#a6e22e>next</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>next</span>()) <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>next</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#34;&#39;</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>eat</span>(<span style=color:#e6db74>&#39;&#34;&#39;</span>)) {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>state</span>.<span style=color:#a6e22e>tokenize</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;string&#34;</span>;
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>function</span> <span style=color:#a6e22e>mimes</span>(<span style=color:#a6e22e>ms</span>, <span style=color:#a6e22e>mode</span>) {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>ms</span>.<span style=color:#a6e22e>length</span>; <span style=color:#f92672>++</span><span style=color:#a6e22e>i</span>) <span style=color:#a6e22e>CodeMirror</span>.<span style=color:#a6e22e>defineMIME</span>(<span style=color:#a6e22e>ms</span>[<span style=color:#a6e22e>i</span>], <span style=color:#a6e22e>mode</span>);
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>mimes</span>([<span style=color:#e6db74>&#34;text/x-rustsrc&#34;</span>, <span style=color:#e6db74>&#34;text/x-rust&#34;</span>], {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;rust&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>keywords</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>words</span>(<span style=color:#a6e22e>rustKeywords</span>),
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>blockKeywords</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>words</span>(<span style=color:#e6db74>&#34;enum struct&#34;</span>),
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>atoms</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>words</span>(<span style=color:#e6db74>&#34;true false None Some&#34;</span>),
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>hooks</span><span style=color:#f92672>:</span> { <span style=color:#e6db74>&#34;#&#34;</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>rustHook</span> }
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>}());
</span></span></code></pre></div><h2 id=8-测试运行>8. 测试运行</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm run dev
</span></span></code></pre></div><p>访问页面</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> VITE v5.2.8  ready in <span style=color:#ae81ff>177</span> ms
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ➜  Local:   http://localhost:5173/  <span style=color:#75715e># 访问这个地址可以打开</span>
</span></span><span style=display:flex><span>  ➜  Network: use --host to expose
</span></span><span style=display:flex><span>  ➜  press h + enter to show help
</span></span></code></pre></div><blockquote><p>如果无法运行
报错：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> <span style=color:#f92672>[</span>vite<span style=color:#f92672>]</span> Internal server error: Missing <span style=color:#e6db74>&#34;./lib/codemirror.css&#34;</span> specifier in <span style=color:#e6db74>&#34;codemirror&#34;</span> package
</span></span></code></pre></div><p>检查 <code>paclage.json</code> 中的 <code>"codemirror": "^5.65.16"</code> 版本是否正确</p></blockquote><p><img src=https://www.caoyang2002.top/usr/uploads/2024/04/2369201853.png alt=前端></p><blockquote><p>这时候点击 <code>执行</code> 会出错，因为还没写服务端</p></blockquote><h1 id=二服务端rust>二、服务端（rust）</h1><h2 id=1-安装-rust安装-rust-时会默认安装-cargo>1. 安装 Rust（安装 Rust 时会默认安装 Cargo）</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl --proto <span style=color:#e6db74>&#39;=https&#39;</span> --tlsv1.2 -sSf https://sh.rustup.rs | sh
</span></span></code></pre></div><blockquote><p>按照提示操作，选择默认选项安装即可。</p></blockquote><h2 id=2-rust-环境>2. Rust 环境</h2><blockquote><p>安装完成后，根据终端中的提示，运行以下命令将 Rust 工具链添加到您的 shell 环境中：</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>source $HOME/.cargo/env
</span></span></code></pre></div><h2 id=3-验证安装>3. 验证安装</h2><blockquote><p>在终端中运行以下命令来验证 Rust 和 Cargo 是否成功安装：</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rustc --version <span style=color:#75715e># 或者 rustc -V</span>
</span></span><span style=display:flex><span>cargo --version   <span style=color:#75715e># 或者 cargo -V</span>
</span></span></code></pre></div><blockquote><p>查看帮助</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rustc --help
</span></span><span style=display:flex><span>cargo --help
</span></span><span style=display:flex><span>cargo run --help
</span></span><span style=display:flex><span>cargo build --help
</span></span></code></pre></div></blockquote><h2 id=4-创建-rust-项目>4. 创建 Rust 项目</h2><blockquote><p>在您选择的目录中，打开终端。</p></blockquote><p>创建一个新的 Rust 项目</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cargo new rust_move_server  <span style=color:#75715e># rust_move_server 是项目的名称，它会创建一个该名称的文件夹作为项目根目录</span>
</span></span></code></pre></div><p>{bs-accord style=line title=文件解析}
<code>Cargo.toml</code> 是 Rust 项目的配置文件，类似于其他语言中的 package.json 或者 requirements.txt。它用来指定项目的元数据、依赖项以及构建配置等信息。您可以在 Cargo.toml 中指定项目的名称、版本号、作者信息等，同时也可以列出项目的依赖项和构建脚本。</p><p><code>src</code> 目录是 Rust 项目的源代码目录，其中包含了您编写的 Rust 源代码文件。通常情况下，Rust 项目的主要源代码文件会放在 src 目录下。您可以在 src 目录中创建 Rust 源代码文件（通常以 .rs 扩展名结尾），并在这些文件中编写 Rust 代码来实现项目的功能。</p><blockquote><p>初始的 <code>src</code> 目录内包含一个 <code>main.rs</code> 文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>fn</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    println!(<span style=color:#e6db74>&#34;Hello, world!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></blockquote><p>{/bs-accord}</p><h2 id=5-进入项目目录>5. 进入项目目录</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd rust_move_server
</span></span></code></pre></div><blockquote><p>进入您新创建的项目目录。</p></blockquote><h2 id=6-构建项目>6. 构建项目</h2><blockquote><p>您新创建的项目目录内</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cargo build
</span></span></code></pre></div><blockquote><p>Cargo 将会自动下载和构建项目的依赖项，并生成可执行文件。</p></blockquote><h2 id=7-运行项目>7. 运行项目</h2><blockquote><p>构建完成后，您可以在项目目录中找到生成的可执行文件。</p></blockquote><p>执行项目</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./target/debug/your_project_name
</span></span></code></pre></div><p>{bs-accord style=line title=构建同时运行}</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cargo run
</span></span></code></pre></div><p>用于构建并运行 Rust 项目的可执行文件。它实际上是 <code>cargo build</code> 和执行生成的可执行文件的组合操作。</p><p>具体来说，<code>cargo run</code> 命令会执行以下操作：</p><ol><li><p><strong>构建项目</strong>：如果项目尚未构建，<code>cargo run</code> 会首先执行与 <code>cargo build</code> 相同的操作，即编译 Rust 项目的源代码并生成可执行文件。如果项目已经构建过，它会跳过这一步，除非代码或依赖项发生了变化。</p></li><li><p><strong>运行可执行文件</strong>：一旦项目构建完成，<code>cargo run</code> 会自动在项目的 <code>target/debug</code> 目录中查找生成的可执行文件，并将其运行起来。如果项目是库项目而不是可执行文件项目，则 <code>cargo run</code> 不会执行任何操作，因为库项目没有可执行文件。</p></li><li><p><strong>传递参数</strong>：<code>cargo run</code> 命令可以接受额外的参数，并将它们传递给生成的可执行文件。这些参数可以在执行可执行文件时使用，例如指定程序的运行配置或传递运行时参数。
{/bs-accord}</p></li></ol><h2 id=8-写入-rust-服务端代码>8. 写入 Rust 服务端代码</h2><h3 id=81-配置依赖项-cargotoml>8.1 配置依赖项 <code>Cargo.toml</code></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>package<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;test_server&#34;</span>
</span></span><span style=display:flex><span>version <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0.1.0&#34;</span>
</span></span><span style=display:flex><span>edition <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;2021&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>dependencies<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>actix-web <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;4.0&#34;</span>
</span></span><span style=display:flex><span>actix-cors <span style=color:#f92672>=</span> <span style=color:#f92672>{</span> version <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0.6.0-beta.10&#34;</span> <span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=82-写入rust-代码>8.2 写入Rust 代码</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>use actix_web::<span style=color:#f92672>{</span>web, App, HttpResponse, HttpServer, Responder<span style=color:#f92672>}</span>;
</span></span><span style=display:flex><span>use std::process::<span style=color:#f92672>{</span>Command, Stdio<span style=color:#f92672>}</span>;
</span></span><span style=display:flex><span>use std::fs;
</span></span><span style=display:flex><span>use std::path::Path;
</span></span><span style=display:flex><span>use std::str;
</span></span><span style=display:flex><span>use actix_cors::Cors;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>async fn compile_and_run_move<span style=color:#f92672>(</span>move_code: web::Bytes<span style=color:#f92672>)</span> -&gt; impl Responder <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    println!<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Received Move code: {:?}&#34;</span>, move_code<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    // 创建临时文件目录
</span></span><span style=display:flex><span>    let tmp_dir <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/tmp&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> !Path::new<span style=color:#f92672>(</span>tmp_dir<span style=color:#f92672>)</span>.exists<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        fs::create_dir<span style=color:#f92672>(</span>tmp_dir<span style=color:#f92672>)</span>.expect<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Failed to create temporary directory&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    // 将接收到的 Move 代码写入临时文件
</span></span><span style=display:flex><span>    let tmp_file <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/Users/caoyang/Documents/Aptos/ts_playground/move_code/sources/test.move&#34;</span>;
</span></span><span style=display:flex><span>    fs::write<span style=color:#f92672>(</span>tmp_file, move_code<span style=color:#f92672>)</span>.expect<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;写入文件：Failed to write Move code to file&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    // 编译 Move 代码
</span></span><span style=display:flex><span>let compile_output <span style=color:#f92672>=</span> Command::new<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;aptos&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    .arg<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;move&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    .arg<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;test&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    .arg<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;--package-dir&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    .arg<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/Users/caoyang/Documents/Aptos/ts_playground/move_code&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    .output<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    .expect<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Failed to execute aptos move test command&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> !compile_output.status.success<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    let stderr <span style=color:#f92672>=</span> str::from_utf8<span style=color:#f92672>(</span>&amp;compile_output.stderr<span style=color:#f92672>)</span>.unwrap_or<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Error reading stderr&#34;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> HttpResponse::InternalServerError<span style=color:#f92672>()</span>.body<span style=color:#f92672>(</span>format!<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Move compilation failed: {}&#34;</span>, stderr<span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    // 将运行结果作为响应返回给客户端
</span></span><span style=display:flex><span>    HttpResponse::Ok<span style=color:#f92672>()</span>.body<span style=color:#f92672>(</span>String::from_utf8_lossy<span style=color:#f92672>(</span>&amp;compile_output.stdout<span style=color:#f92672>)</span>.to_string<span style=color:#f92672>())</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#[actix_web::main]</span>
</span></span><span style=display:flex><span>async fn main<span style=color:#f92672>()</span> -&gt; std::io::Result&lt;<span style=color:#f92672>()</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    // 启动服务器
</span></span><span style=display:flex><span>    HttpServer::new<span style=color:#f92672>(||</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        App::new<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>            // 添加CORS中间件
</span></span><span style=display:flex><span>            .wrap<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>                Cors::permissive<span style=color:#f92672>()</span> // &lt;- 使用 Cors::permissive<span style=color:#f92672>()</span> 替换 Cors::new<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>                    .allowed_origin<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;http://localhost:5173&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>            // 定义路由
</span></span><span style=display:flex><span>            .route<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/run_move&#34;</span>, web::post<span style=color:#f92672>()</span>.to<span style=color:#f92672>(</span>compile_and_run_move<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>})</span>
</span></span><span style=display:flex><span>    .bind<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;127.0.0.1:8081&#34;</span><span style=color:#f92672>)</span>?
</span></span><span style=display:flex><span>    .run<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>    .await
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=9-发送-post-请求进行测试>9. 发送 post 请求进行测试</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> curl -X POST -d <span style=color:#e6db74>&#39;module 0x12::test{
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  use std::debug::print;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  use std::string::utf8;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  #[test]
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  fun test_server(){
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    print(&amp;utf8(b&#34;server is running&#34;));
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  }
</span></span></span><span style=display:flex><span><span style=color:#e6db74>}&#39;</span> http://127.0.0.1:8081/run_move
</span></span></code></pre></div><h2 id=rust-部分完成>Rust 部分完成</h2><h1 id=三move-临时代码>三、move 临时代码</h1><blockquote><p>这个目录主要是用于存储前端的代码，然后执行这段代码，将结果返回给前端</p></blockquote><ul><li>先创建目录</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir move_code_tmp
</span></span><span style=display:flex><span>cd move_code_tmp
</span></span></code></pre></div><h2 id=1-初始化-move-项目>1. 初始化 Move 项目</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aptos move init  --name move_code
</span></span></code></pre></div><blockquote><p>这个命令会在当前目录下初始化一个 move 项目，不会新创建项目，
根据提示输入内容，或者直接回车
创建的 <code>Move.toml</code> 包含了程序的配置信息</p></blockquote><p>返回结果</p><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>caoyang@cccy move_code_tmp % aptos move init  --name move_code
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span> <span style=color:#e6db74>&#34;Result&#34;</span>: <span style=color:#e6db74>&#34;Success&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></blockquote><h2 id=2-初始化-aptos-账户>2. 初始化 aptos 账户</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aptos init --network testnet
</span></span></code></pre></div><blockquote><p>这个命令会在 <code>.aptos</code> 目录下创建一个 <code>config.yaml</code> 文件，这个文件包含了账户的所有信息</p></blockquote><p>返回结果</p><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>caoyang@cccy move_code_tmp % aptos init --network testnet
</span></span><span style=display:flex><span>Configuring <span style=color:#66d9ef>for</span> profile default
</span></span><span style=display:flex><span>Configuring <span style=color:#66d9ef>for</span> network Testnet
</span></span><span style=display:flex><span>Enter your private key as a hex literal <span style=color:#f92672>(</span>0x...<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>Current: None | No input: Generate new key <span style=color:#f92672>(</span>or keep one <span style=color:#66d9ef>if</span> present<span style=color:#f92672>)]</span>
</span></span><span style=display:flex><span> No key given, generating key...
</span></span><span style=display:flex><span> Account 0x3846fb4052a41807816c58611911e913526e2370cd97a160025cc7dc670efeff doesn<span style=color:#960050;background-color:#1e0010>&#39;</span>t exist, creating it and funding it with <span style=color:#ae81ff>100000000</span> Octas
</span></span><span style=display:flex><span> Account 0x3846fb4052a41807816c58611911e913526e2370cd97a160025cc7dc670efeff funded successfully
</span></span><span style=display:flex><span> ---
</span></span><span style=display:flex><span> Aptos CLI is now set up <span style=color:#66d9ef>for</span> account 0x3846fb4052a41807816c58611911e913526e2370cd97a160025cc7dc670efeff as profile default!  Run <span style=color:#e6db74>`</span>aptos --help<span style=color:#e6db74>`</span> <span style=color:#66d9ef>for</span> more information about commands
</span></span><span style=display:flex><span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>   <span style=color:#e6db74>&#34;Result&#34;</span>: <span style=color:#e6db74>&#34;Success&#34;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>}</span>
</span></span></code></pre></div></blockquote><h2 id=3-创建临时-move-代码文件-tempmove>3. 创建临时 Move 代码文件 <code>temp.move</code></h2><blockquote><p>用于临时存储前端发送的 Move 代码，并执行代码</p></blockquote><h3 id=31-输入一段-move-代码>3.1 输入一段 Move 代码</h3><pre tabindex=0><code class=language-move data-lang=move>module 0x42::test{
    use std::debug::print;
	  use std::string::utf8;
    #[test]
    fun test_my(){
        print(&amp;utf8(b&#34;server is running&#34;));
    }
}
</code></pre><h3 id=32-测试运行>3.2 测试运行</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aptos move test
</span></span></code></pre></div><p>返回的结果</p><blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>caoyang@cccy move_code_tmp % aptos move test
</span></span><span style=display:flex><span>INCLUDING DEPENDENCY AptosFramework
</span></span><span style=display:flex><span>INCLUDING DEPENDENCY AptosStdlib
</span></span><span style=display:flex><span>INCLUDING DEPENDENCY MoveStdlib
</span></span><span style=display:flex><span>BUILDING move_code
</span></span><span style=display:flex><span>warning: unused alias
</span></span><span style=display:flex><span>  ┌─ /Users/caoyang/Documents/Aptos/del/move_code_tmp/sources/temp.move:2:21
</span></span><span style=display:flex><span>  │
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span> │     use std::debug::print;
</span></span><span style=display:flex><span>  │                     ^^^^^ Unused <span style=color:#e6db74>&#39;use&#39;</span> of alias <span style=color:#e6db74>&#39;print&#39;</span>. Consider removing it    <span style=color:#75715e># 这是正常的，因为未使用</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>warning: unused alias
</span></span><span style=display:flex><span>  ┌─ /Users/caoyang/Documents/Aptos/del/move_code_tmp/sources/temp.move:3:21
</span></span><span style=display:flex><span>  │
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> │       use std::string::utf8;
</span></span><span style=display:flex><span>  │                        ^^^^ Unused <span style=color:#e6db74>&#39;use&#39;</span> of alias <span style=color:#e6db74>&#39;utf8&#39;</span>. Consider removing it    <span style=color:#75715e># 这是正常的，因为未使用</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Running Move unit tests
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>debug<span style=color:#f92672>]</span> <span style=color:#e6db74>&#34;server is running&#34;</span>   <span style=color:#75715e># 输出了源码中预期的结果</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> PASS    <span style=color:#f92672>]</span> 0x42::test::test_my
</span></span><span style=display:flex><span>Test result: OK. Total tests: 1; passed: 1; failed: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;Result&#34;</span>: <span style=color:#e6db74>&#34;Success&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div></blockquote><h2 id=move-部分完成>Move 部分完成</h2><h1 id=四测试>四、测试</h1><blockquote><p>输入以下代码后，点击 <code>执行</code>，等待一段时间后，可以看到执行结果区域有输出</p></blockquote><pre tabindex=0><code class=language-move data-lang=move>module 0x12::test{
  use std::debug::print;
  use std::string::utf8;
  #[test]
  fun test_server(){
    print(&amp;utf8(b&#34;server is running&#34;));
  }
}
</code></pre><p><img src=https://www.caoyang2002.top/usr/uploads/2024/04/2477546867.png alt></p><h1 id=五目录结构>五、目录结构</h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> tree -I <span style=color:#e6db74>&#39;node_modules|build|target&#39;</span> ./
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>caoyang@cccy ts_playground % tree -I <span style=color:#e6db74>&#39;node_modules|build|target&#39;</span> ./
</span></span><span style=display:flex><span>./
</span></span><span style=display:flex><span>├── move_code   <span style=color:#75715e># move 程序代码</span>
</span></span><span style=display:flex><span>│   ├── Move.toml  <span style=color:#75715e># 可以更换为国内源</span>
</span></span><span style=display:flex><span>│   ├── scripts
</span></span><span style=display:flex><span>│   ├── sources
</span></span><span style=display:flex><span>│   │   └── temp.move  <span style=color:#75715e># move 临时代码</span>
</span></span><span style=display:flex><span>│   └── tests
</span></span><span style=display:flex><span>├── playground
</span></span><span style=display:flex><span>│   ├── README.md
</span></span><span style=display:flex><span>│   ├── codemirror.d.ts
</span></span><span style=display:flex><span>│   ├── index.html
</span></span><span style=display:flex><span>│   ├── package-lock.json
</span></span><span style=display:flex><span>│   ├── package.json
</span></span><span style=display:flex><span>│   ├── public
</span></span><span style=display:flex><span>│   │   └── vite.svg <span style=color:#75715e># 这个可以删掉</span>
</span></span><span style=display:flex><span>│   ├── src
</span></span><span style=display:flex><span>│   │   ├── App.tsx <span style=color:#75715e># 取消严格模式，防止渲染两个输入框</span>
</span></span><span style=display:flex><span>│   │   ├── assets
</span></span><span style=display:flex><span>│   │   │   └── react.svg  <span style=color:#75715e># 这个可以删掉</span>
</span></span><span style=display:flex><span>│   │   ├── main.tsx
</span></span><span style=display:flex><span>│   │   ├── move.js  <span style=color:#75715e># 高亮语法</span>
</span></span><span style=display:flex><span>│   │   ├── playground.tsx  <span style=color:#75715e># 文本编辑器</span>
</span></span><span style=display:flex><span>│   │   └── vite-env.d.ts
</span></span><span style=display:flex><span>│   ├── tsconfig.json
</span></span><span style=display:flex><span>│   ├── tsconfig.node.json
</span></span><span style=display:flex><span>│   └── vite.config.ts
</span></span><span style=display:flex><span>└── rust_move_server  <span style=color:#75715e># rust 服务端，用于接受 post 请求，并返回 move 的执行结果</span>
</span></span><span style=display:flex><span>    └── test_server
</span></span><span style=display:flex><span>        ├── Cargo.lock
</span></span><span style=display:flex><span>        ├── Cargo.toml  <span style=color:#75715e># 需要配置依赖项</span>
</span></span><span style=display:flex><span>        └── src
</span></span><span style=display:flex><span>            └── main.rs <span style=color:#75715e># 服务端代码</span>
</span></span></code></pre></div><h1 id=附录>附录</h1><h2 id=playground>playground</h2><h3 id=packagejson>package.json</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;playground&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;private&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.0.0&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;module&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;scripts&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;dev&#34;</span>: <span style=color:#e6db74>&#34;vite&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;build&#34;</span>: <span style=color:#e6db74>&#34;tsc &amp;&amp; vite build&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;lint&#34;</span>: <span style=color:#e6db74>&#34;eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;preview&#34;</span>: <span style=color:#e6db74>&#34;vite preview&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;dependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;axios&#34;</span>: <span style=color:#e6db74>&#34;^1.6.8&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;codemirror&#34;</span>: <span style=color:#e6db74>&#34;^5.65.16&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;react&#34;</span>: <span style=color:#e6db74>&#34;^18.2.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;react-codemirror2&#34;</span>: <span style=color:#e6db74>&#34;^7.3.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;react-dom&#34;</span>: <span style=color:#e6db74>&#34;^18.2.0&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;devDependencies&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;@types/codemirror&#34;</span>: <span style=color:#e6db74>&#34;^5.60.15&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;@types/react&#34;</span>: <span style=color:#e6db74>&#34;^18.2.66&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;@types/react-dom&#34;</span>: <span style=color:#e6db74>&#34;^18.2.22&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;@typescript-eslint/eslint-plugin&#34;</span>: <span style=color:#e6db74>&#34;^7.2.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;@typescript-eslint/parser&#34;</span>: <span style=color:#e6db74>&#34;^7.2.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;@vitejs/plugin-react&#34;</span>: <span style=color:#e6db74>&#34;^4.2.1&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;eslint&#34;</span>: <span style=color:#e6db74>&#34;^8.57.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;eslint-plugin-react-hooks&#34;</span>: <span style=color:#e6db74>&#34;^4.6.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;eslint-plugin-react-refresh&#34;</span>: <span style=color:#e6db74>&#34;^0.4.6&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;typescript&#34;</span>: <span style=color:#e6db74>&#34;^5.2.2&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;vite&#34;</span>: <span style=color:#e6db74>&#34;^5.2.0&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=rust>rust</h2><h3 id=cargotoml>Cargo.toml</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[<span style=color:#a6e22e>package</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>name</span> = <span style=color:#e6db74>&#34;rust_move_server&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>version</span> = <span style=color:#e6db74>&#34;0.1.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>edition</span> = <span style=color:#e6db74>&#34;2021&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#a6e22e>dependencies</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>actix-web</span> = <span style=color:#e6db74>&#34;4.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>actix-cors</span> = { <span style=color:#a6e22e>version</span> = <span style=color:#e6db74>&#34;0.6.0-beta.10&#34;</span> }
</span></span></code></pre></div><h2 id=move>move</h2><h3 id=movetoml>Move.toml</h3><pre tabindex=0><code class=language-move data-lang=move>[package]
name = &#34;move_code&#34;
version = &#34;1.0.0&#34;
authors = []

[addresses]

[dev-addresses]

[dependencies.AptosFramework]
git = &#34;https://github.com/aptos-labs/aptos-core.git&#34;
rev = &#34;mainnet&#34;
subdir = &#34;aptos-move/framework/aptos-framework&#34;

[dev-dependencies]
</code></pre></section><nav class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg !leading-[1.2] *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"><a class="ltr:pr-3 rtl:pl-3" href=https://caoyang2002.xyz/post/2024/04/compent/><span class="ltr:mr-1.5 rtl:ml-1.5">←</span><span>报税记账</span></a>
<a class="ltr:ml-auto rtl:mr-auto justify-end pl-3" href=https://caoyang2002.xyz/post/2024/04/design/><span>设计资料：样机</span><span class="ltr:ml-1.5 rtl:mr-1.5">→</span></a></nav><div class="mt-24 w-100rem" id=disqus_thread></div><script>const disqusShortname="caoyang2002.xyz",script=document.createElement("script");script.src="https://"+disqusShortname+".disqus.com/embed.js",script.setAttribute("data-timestamp",+new Date),document.head.appendChild(script)</script><div class="giscus mt-24"></div><script src=https://giscus.app/client.js data-repo=caoyang2002/caoyang2002 data-repo-id=R_kgDONgnnzg data-category=Announcements data-category-id=DIC_kwDONgnnzs4ClayH data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><div class=ml-2><button class=mobile-toc-toggle><svg t="1737363365612" class="icon" viewBox="0 0 1024 1024" p-id="7154" width="32" height="32"><path d="M811.6 264.1H378.2c-19.8.0-36-16.2-36-36s16.2-36 36-36h433.5c19.8.0 36 16.2 36 36-.1 19.8-16.3 36-36.1 36zm0 258H378.2c-19.8.0-36-16.2-36-36s16.2-36 36-36h433.5c19.8.0 36 16.2 36 36-.1 19.8-16.3 36-36.1 36zm0 258H378.2c-19.8.0-36-16.2-36-36s16.2-36 36-36h433.5c19.8.0 36 16.2 36 36-.1 19.8-16.3 36-36.1 36z" fill="#223d60" p-id="7155"/><path d="M210.2 229m-37.9.0a37.9 37.9.0 1075.8.0 37.9 37.9.0 10-75.8.0z" fill="#223d60" p-id="7156"/><path d="M210.2 487m-37.9.0a37.9 37.9.0 1075.8.0 37.9 37.9.0 10-75.8.0z" fill="#223d60" p-id="7157"/><path d="M210.2 745m-37.9.0a37.9 37.9.0 1075.8.0 37.9 37.9.0 10-75.8.0z" fill="#223d60" p-id="7158"/></svg></button><aside class=toc-aside><div class=toc-container><div class=toc-header><h3 class=toc-title>目录</h3><button class=toc-close><svg viewBox="0 0 24 24" width="24" height="24"><path fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6M6 6l12 12"/></svg></button></div><nav id=TableOfContents class=toc><nav id=TableOfContents><ul><li><a href=#一前端tsreact>一、前端（ts、react）</a><ul><li><a href=#1-初始化模板>1. 初始化模板</a><ul><li><a href=#11-交互式>1.1 交互式</a></li><li><a href=#12-一键创建>1.2 一键创建</a></li></ul></li><li><a href=#2-安装并运行模板>2. 安装并运行模板</a></li><li><a href=#3-删除不需要的文件>3. 删除不需要的文件</a></li><li><a href=#4-创建-playgroundtsx-组件>4. 创建 <code>playground.tsx</code> 组件</a></li><li><a href=#5-修改maintsx>5. 修改<code>main.tsx</code></a></li><li><a href=#6-修改apptsx>6. 修改<code>App.tsx</code></a></li><li><a href=#7-创建语法高亮-movejs>7. 创建语法高亮 <code>move.js</code></a></li><li><a href=#8-测试运行>8. 测试运行</a></li></ul></li><li><a href=#二服务端rust>二、服务端（rust）</a><ul><li><a href=#1-安装-rust安装-rust-时会默认安装-cargo>1. 安装 Rust（安装 Rust 时会默认安装 Cargo）</a></li><li><a href=#2-rust-环境>2. Rust 环境</a></li><li><a href=#3-验证安装>3. 验证安装</a></li><li><a href=#4-创建-rust-项目>4. 创建 Rust 项目</a></li><li><a href=#5-进入项目目录>5. 进入项目目录</a></li><li><a href=#6-构建项目>6. 构建项目</a></li><li><a href=#7-运行项目>7. 运行项目</a></li><li><a href=#8-写入-rust-服务端代码>8. 写入 Rust 服务端代码</a><ul><li><a href=#81-配置依赖项-cargotoml>8.1 配置依赖项 <code>Cargo.toml</code></a></li><li><a href=#82-写入rust-代码>8.2 写入Rust 代码</a></li></ul></li><li><a href=#9-发送-post-请求进行测试>9. 发送 post 请求进行测试</a></li><li><a href=#rust-部分完成>Rust 部分完成</a></li></ul></li><li><a href=#三move-临时代码>三、move 临时代码</a><ul><li><a href=#1-初始化-move-项目>1. 初始化 Move 项目</a></li><li><a href=#2-初始化-aptos-账户>2. 初始化 aptos 账户</a></li><li><a href=#3-创建临时-move-代码文件-tempmove>3. 创建临时 Move 代码文件 <code>temp.move</code></a><ul><li><a href=#31-输入一段-move-代码>3.1 输入一段 Move 代码</a></li><li><a href=#32-测试运行>3.2 测试运行</a></li></ul></li><li><a href=#move-部分完成>Move 部分完成</a></li></ul></li><li><a href=#四测试>四、测试</a></li><li><a href=#五目录结构>五、目录结构</a></li><li><a href=#附录>附录</a><ul><li><a href=#playground>playground</a><ul><li><a href=#packagejson>package.json</a></li></ul></li><li><a href=#rust>rust</a><ul><li><a href=#cargotoml>Cargo.toml</a></li></ul></li><li><a href=#move>move</a><ul><li><a href=#movetoml>Move.toml</a></li></ul></li></ul></li></ul></nav></nav></div></aside><style>.toc-aside{position:fixed;top:6rem;bottom:4rem;right:0;width:16rem;z-index:100;transition:transform .3s ease}.toc-container{background:#fff;height:100%;border-radius:.5rem .5rem .5rem .5rem;box-shadow:-2px 0 8px rgba(0,0,0,.1);display:flex;flex-direction:column}.toc-header{position:sticky;border-radius:.5rem .5rem 0 0;top:0;background:#fff;padding:1rem;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center;z-index:10}.toc-title{margin:0;font-size:1rem;font-weight:600}.mobile-toc-toggle{display:none;position:fixed;top:6rem;right:1rem;z-index:99;width:3rem;height:3rem;border-radius:50%;background:#fff;border:1px solid #e5e7eb;box-shadow:0 2px 8px rgba(0,0,0,.1);color:#4b5563;cursor:pointer;transition:all .2s}.mobile-toc-toggle:hover{background:#f3f4f6}.mobile-toc-toggle .menu-icon{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.toc-close{padding:.5rem;background:0 0;border:none;color:#4b5563;cursor:pointer;transition:all .2s}.toc-close:hover{color:#111827}.toc{flex:1;overflow-y:auto;padding:1rem;scrollbar-gutter:stable}.toc ul{list-style:none;padding-left:1rem;margin:0}.toc li{margin:.5rem 0}.toc a{display:block;padding:.25rem .5rem;color:#4b5563;text-decoration:none;border-radius:.25rem;transition:all .2s}.toc a:hover{background-color:#f3f4f6;color:#111827}.toc a.active{background-color:#f3f4f6;color:#111827;font-weight:500}.toc::-webkit-scrollbar{width:4px}.toc::-webkit-scrollbar-track{background:0 0}.toc::-webkit-scrollbar-thumb{background-color:#d1d1d1;border-radius:4px}@media(max-width:912px){.mobile-toc-toggle{display:flex;justify-content:center;align-items:center}.toc-aside{transform:translateX(100%);width:80vw;max-width:20rem}.toc-aside.show{transform:translateX(0)}}@media(prefers-color-scheme:dark){.toc-container,.toc-header{background:#262626;color:#e5e7eb}.toc-header{border-bottom-color:#404040}.mobile-toc-toggle{background:#262626;border-color:#404040;color:#e5e7eb}.mobile-toc-toggle:hover{background:#374151}.toc-close{color:#e5e7eb}.toc-close:hover{color:#f3f4f6}.toc a{color:#9ca3af}.toc a:hover,.toc a.active{background-color:#374151;color:#e5e7eb}.toc::-webkit-scrollbar-thumb{background-color:#4b5563}}h1,h2,h3,h4,h5,h6{scroll-margin-top:100px}</style><script>document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".toc-aside"),t=document.querySelector(".mobile-toc-toggle"),n=document.querySelector(".toc-close");t?.addEventListener("click",()=>{e?.classList.add("show")}),n?.addEventListener("click",()=>{e?.classList.remove("show")}),document.addEventListener("click",n=>{window.innerWidth<=912&&e?.classList.contains("show")&&!e.contains(n.target)&&!t?.contains(n.target)&&e.classList.remove("show")});const s=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target.getAttribute("id"),n=document.querySelector(`.toc a[href="#${t}"]`);e.intersectionRatio>0&&(document.querySelectorAll(".toc a.active").forEach(e=>{e.classList.remove("active")}),n?.classList.add("active"))})},{rootMargin:"-20% 0px -80% 0px"});document.querySelectorAll("h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]").forEach(e=>{s.observe(e)})})</script></div></div><footer class="flex items-center text-xs uppercase"><div class="mr-auto opacity-60">&copy; 2025
<a class=link href=https://caoyang2002.xyz/>caoyang2002</a></div><div><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><p class="link mx-6 opacity-60">本站访问
<span id=busuanzi_value_page_pv><i class="fa fa-spinner fa-spin"></i></span>
次</p></div><a class="link mx-6 opacity-60" href=https://gohugo.io/ rel=noopener target=_blank>powered by hugo️️</a>️
<a class="link mx-6 opacity-60" href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>hugo-paper</a>
<a class="link opacity-60" href=https://github.com/caoyang2002/hugo-focus rel=noopener target=_blank>hugo-focus</a></footer><style>footer{position:fixed;bottom:0;left:0;right:0;z-index:50;width:100%;padding:.5rem;padding-bottom:calc(.5rem + var(--safe-padding-bottom));padding-left:max(.5rem,var(--safe-padding-left));padding-right:max(.5rem,var(--safe-padding-right));display:flex;justify-content:center;align-items:center;backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(12px);background:rgba(255,255,255,.85);border-top:1px solid rgba(255,255,255,.3);box-shadow:0 -4px 20px rgba(0,0,0,5%)}.dark footer{background:rgba(0,0,0,.85);border-top-color:rgba(255,255,255,.1)}.footer-content{width:100%;max-width:var(--w);margin:0 auto;padding:0 1rem;display:flex;flex-direction:row;align-items:center;justify-content:space-between;gap:1rem}.footer-element{padding:.75rem 1.5rem;font-size:.75rem;text-transform:uppercase;letter-spacing:.05em;opacity:.8;border-radius:.5rem;background:rgba(255,255,255,.1);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);transition:all .2s ease}.footer-element:hover{opacity:1;background:rgba(255,255,255,.2)}.dark .footer-element{background:rgba(255,255,255,5%)}.dark .footer-element:hover{background:rgba(255,255,255,.1)}@media(max-width:768px){footer{padding-top:.5rem;padding-bottom:calc(.5rem + env(safe-area-inset-bottom))}.footer-content{padding:0 .5rem;gap:.5rem}.footer-element{padding:.5rem 1rem;font-size:.75rem}}@media(min-width:768px){.footer-element{font-size:.875rem}}@media(min-width:1024px){.footer-content{padding:0 2rem;gap:2rem}.footer-element{padding:.75rem 2rem}}</style></body></html>