<!doctype html><html class="not-ready lg:text-base close" style=--bg:#faf8f1 lang=zh-CN dir=ltr><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>JWT 解析 - caoyang2002</title>
<meta name=theme-color><meta name=description content="
原文一
原文二
视频
一、什么是 JWT
JSON Web Token (JWT)是一个开放标准(RFC 7519)，它定义了一种紧凑的、自包含的方式，用于作为JSON对象在各方之间安全地传输信息。该信息可以被验证和信任，因为它是数字签名的。
二、设计目标
不需要服务器端存储状态，安全地传递非敏感信息

三、 JSON Web Token 的结构是什么样的
JSON Web Token由三部分组成，例如dafdsafdwfefeqwad.oijhdaffweqtgfdhfdws.dhshfsghhhhhwfsdke"><meta name=author content="Cyrus"><link rel="preload stylesheet" as=style href=https://caoyang2002.xyz/main.min.css><link rel=preload as=image href=https://caoyang2002.xyz/theme.png><link rel=preload as=image href="https://www.gravatar.com/avatar/d0bdfd42ef81555f2c2372b61609c73d?s=160&amp;d=identicon"><link rel=preload as=image href=https://caoyang2002.xyz/twitter.svg><link rel=preload as=image href=https://caoyang2002.xyz/github.svg><link rel=preload as=image href=https://caoyang2002.xyz/instagram.svg><link rel=preload as=image href=https://caoyang2002.xyz/rss.svg><script defer src=https://caoyang2002.xyz/highlight.min.js onload=hljs.initHighlightingOnLoad()></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css integrity=sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js integrity=sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",()=>renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],throwOnError:!1}))</script><link rel=icon href=https://caoyang2002.xyz/favicon.ico><link rel=apple-touch-icon href=https://caoyang2002.xyz/apple-touch-icon.png><meta name=generator content="Hugo 0.140.2"><meta itemprop=name content="JWT 解析"><meta itemprop=description content="原文一
原文二
视频
一、什么是 JWT JSON Web Token (JWT)是一个开放标准(RFC 7519)，它定义了一种紧凑的、自包含的方式，用于作为JSON对象在各方之间安全地传输信息。该信息可以被验证和信任，因为它是数字签名的。
二、设计目标 不需要服务器端存储状态，安全地传递非敏感信息
三、 JSON Web Token 的结构是什么样的 JSON Web Token由三部分组成，例如dafdsafdwfefeqwad.oijhdaffweqtgfdhfdws.dhshfsghhhhhwfsdke"><meta itemprop=datePublished content="2024-04-12T09:31:37+08:00"><meta itemprop=dateModified content="2025-01-05T10:56:18+08:00"><meta itemprop=wordCount content="3976"><meta property="og:url" content="https://caoyang2002.xyz/post/2024/04/jwt-%E8%A7%A3%E6%9E%90/"><meta property="og:site_name" content="caoyang2002"><meta property="og:title" content="JWT 解析"><meta property="og:description" content="原文一
原文二
视频
一、什么是 JWT JSON Web Token (JWT)是一个开放标准(RFC 7519)，它定义了一种紧凑的、自包含的方式，用于作为JSON对象在各方之间安全地传输信息。该信息可以被验证和信任，因为它是数字签名的。
二、设计目标 不需要服务器端存储状态，安全地传递非敏感信息
三、 JSON Web Token 的结构是什么样的 JSON Web Token由三部分组成，例如dafdsafdwfefeqwad.oijhdaffweqtgfdhfdws.dhshfsghhhhhwfsdke"><meta property="og:locale" content="zh_CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-12T09:31:37+08:00"><meta property="article:modified_time" content="2025-01-05T10:56:18+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="JWT 解析"><meta name=twitter:description content="原文一
原文二
视频
一、什么是 JWT JSON Web Token (JWT)是一个开放标准(RFC 7519)，它定义了一种紧凑的、自包含的方式，用于作为JSON对象在各方之间安全地传输信息。该信息可以被验证和信任，因为它是数字签名的。
二、设计目标 不需要服务器端存储状态，安全地传递非敏感信息
三、 JSON Web Token 的结构是什么样的 JSON Web Token由三部分组成，例如dafdsafdwfefeqwad.oijhdaffweqtgfdhfdws.dhshfsghhhhhwfsdke"><link rel=canonical href=https://caoyang2002.xyz/post/2024/04/jwt-%E8%A7%A3%E6%9E%90/></head><body class="text-black duration-200 ease-out dark:text-white"><header class="mx-auto flex h-[4.5rem] px-8 lg:justify-center"><div class="relative z-50 ltr:mr-auto rtl:ml-auto flex items-center max-w-[--w]"><a class="-translate-y-[1px] text-2xl font-medium" href=https://caoyang2002.xyz/>caoyang2002</a><div class="btn-dark text-[0] ltr:ml-4 rtl:mr-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]" role=button aria-label=Dark></div></div><div class="btn-menu relative z-50 ltr:-mr-8 rtl:-ml-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden" role=button aria-label=Menu></div><script>const htmlClass=document.documentElement.classList;setTimeout(()=>{htmlClass.remove("not-ready")},10);const btnMenu=document.querySelector(".btn-menu");btnMenu.addEventListener("click",()=>{htmlClass.contains("open")?(htmlClass.remove("open"),htmlClass.add("close")):(htmlClass.remove("close"),htmlClass.add("open"))});const metaTheme=document.querySelector('meta[name="theme-color"]'),lightBg="#faf8f1".replace(/"/g,""),setDark=e=>{metaTheme.setAttribute("content",e?"#000":lightBg),htmlClass[e?"add":"remove"]("dark"),localStorage.setItem("dark",e)},darkScheme=window.matchMedia("(prefers-color-scheme: dark)");if(htmlClass.contains("dark"))setDark(!0);else{const e=localStorage.getItem("dark");setDark(e?e==="true":darkScheme.matches)}darkScheme.addEventListener("change",e=>{setDark(e.matches)});const btnDark=document.querySelector(".btn-dark");btnDark.addEventListener("click",()=>{setDark(localStorage.getItem("dark")!=="true")})</script><div class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"><nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-10 rtl:space-x-reverse"><a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/about/>关于</a>
<a class="block text-center text-xl leading-[5rem] lg:text-base lg:font-normal" href=/contact/>联系</a></nav><nav class="mt-12 flex justify-center space-x-10 rtl:space-x-reverse dark:invert ltr:lg:ml-14 rtl:lg:mr-14 lg:mt-0 lg:items-center"><a class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./twitter.svg) href=https://twitter.com/caoyang2002 target=_blank rel=me>twitter
</a><a class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./github.svg) href=https://github.com/caoyang2002 target=_blank rel=me>github
</a><a class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./instagram.svg) href=https://instagram.com/caoyang2002 target=_blank rel=me>instagram
</a><a class="h-7 w-7 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6" style=--url:url(./rss.svg) href=https://caoyang2002.xyz/index.xml target=_blank rel=alternate>rss</a></nav></div></header><style>header{position:fixed;top:0;left:0;right:0;z-index:50;width:100vw;text-align:center;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);background:rgba(255,255,255,.5);box-shadow:0 4px 30px rgba(0,0,0,.1)}</style><div class="relative flex justify-start max-w-[90vw] px-8"><main class="prose prose-neutral flex-1 min-h-[calc(100vh-9rem)] pt-14 pb-16 dark:prose-invert text-left"><article class=text-left><div class="mb-14 mt-8"><h1 class="!my-0 pb-2.5">JWT 解析</h1><div class="text-xs antialiased opacity-60"><time>2024年4月12日</time></div></div><section><p><img src alt=JWT></p><p><a href=https://zhuanlan.zhihu.com/p/86937325>原文一</a></p><p><a href=https://blog.csdn.net/weixin_39779004/article/details/110801387>原文二</a></p><p><a href=https://b23.tv/3f7Yrct>视频</a></p><h1 id=一什么是-jwt>一、什么是 JWT</h1><p>JSON Web Token (JWT)是一个开放标准(RFC 7519)，它定义了一种紧凑的、自包含的方式，用于作为JSON对象在各方之间安全地传输信息。该信息可以被验证和信任，因为它是数字签名的。</p><h1 id=二设计目标>二、设计目标</h1><p>不需要服务器端存储状态，安全地传递非敏感信息</p><p><img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/OIP-C-20240424140338352.jpeg alt=JWT认证方案讲解-阿里云开发者社区></p><h1 id=三-json-web-token-的结构是什么样的>三、 JSON Web Token 的结构是什么样的</h1><p>JSON Web Token由三部分组成，例如<code>dafdsafdwfefeqwad.oijhdaffweqtgfdhfdws.dhshfsghhhhhwfsdke</code></p><p>简化：<code>xxxxx.yyyyy.zzzzz</code></p><p>可以看到它们之间用圆点(.)连接。</p><p>而这三部分分别是：</p><ul><li>Header 头部</li><li>Payload 载荷</li><li>Signature 签名</li></ul><h2 id=1-header>1. Header</h2><p>由两部分组成：</p><ul><li>token的类型（“JWT”）</li><li>签名算法名称（比如：HMAC SHA256或者RSA等等）</li></ul><p>例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;alg&#39;</span>: <span style=color:#e6db74>&#34;HS256&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;typ&#39;</span>: <span style=color:#e6db74>&#34;JWT&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>然后，用 Base64 对这个 JSON 编码就得到JWT的第一部分</p><h2 id=2-payload>2. Payload</h2><blockquote><p>标准声明：就是该开放标准预先定义的一些字段</p><p>公共声明：是自定义的声明，用于特定应用程序中共享信息</p><p>私有声明：用于在同意双方之间共享信息，通常不会被 JWT 规范定义，而是由应用程序自行定义和使用</p></blockquote><p>它包含声明（要求）。声明是关于实体(通常是用户)和其他数据的声明。声明有三种类型: registered, public 和 private。</p><ul><li>Registered claims : 这里有一组预定义的声明，它们不是强制的，但是推荐。比如：iss (issuer), exp (expiration time), sub (subject), aud (audience)等。</li><li>Public claims : 可以随意定义。</li><li>Private claims : 用于在同意使用它们的各方之间共享信息，并且不是注册的或公开的声明。 下面是一个例子：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;sub&#34;</span>: <span style=color:#e6db74>&#39;1234567890&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#39;john&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;admin&#34;</span>:true
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>对payload进行Base64编码就得到JWT的第二部分</p><p>注意，不要在JWT的payload或header中放置敏感信息，除非它们是加密的。</p><h2 id=3-signature>3. Signature</h2><blockquote><p>为了得到签名部分，你必须有编码过的header、编码过的payload、一个秘钥，签名算法是header中指定的那个，然对它们签名即可。</p></blockquote><p>例如：</p><blockquote><p><code>HMACSHA256(secret, base64UrlEncode(header) + "." + base64UrlEncode(payload))</code></p><ul><li><p>secret 保存在服务端，用来进行 JWT 的签发和验证，所以在任何时候都不应该泄漏</p></li><li><p>JWT 的签发生成也在服务端</p></li><li><p>HMACSHA256 是一种对称加密算法</p><blockquote><p>对称加密算法：用一个密钥加密解密的算法</p><p>非对称加密算法：SSH key（用公钥加密的密文智能用私钥解密，用私钥签发的签名只能用公钥来验证）</p><p><img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/63d0f703918fa0ec16f456372c9759ee3d6ddbdc.jpg alt="（68）对称加密和非对称加密的区别 - 走看看"></p></blockquote></li></ul></blockquote><p>签名是用于验证消息在传递过程中有没有被更改，并且，对于使用私钥签名的token，它还可以验证JWT的发送方是否为它所称的发送方。</p><p>看一张官网的图就明白了：</p><p><img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/v2-2d4a2985706ff9610ad1466b66ba09ad_1440w.webp alt=img></p><h1 id=jwt-是如何工作的>JWT 是如何工作的</h1><p>在认证的时候，当用户用他们的凭证成功登录以后，一个JSON Web Token将会被返回。此后，token就是用户凭证了，你必须非常小心以防止出现安全问题。一般而言，你保存令牌的时候不应该超过你所需要它的时间。</p><p>无论何时用户想要访问受保护的路由或者资源的时候，用户代理（通常是浏览器）都应该带上JWT，典型的，通常放在Authorization header中，用Bearer schema。</p><p>header应该看起来是这样的：</p><blockquote><p>Authorization: Bearer</p></blockquote><p>服务器上的受保护的路由将会检查Authorization header中的JWT是否有效，如果有效，则用户可以访问受保护的资源。如果JWT包含足够多的必需的数据，那么就可以减少对某些操作的数据库查询的需要，尽管可能并不总是如此。</p><p>如果token是在授权头（Authorization header）中发送的，那么跨源资源共享(CORS)将不会成为问题，因为它不使用cookie。</p><h1 id=三场景>三、场景</h1><p>下列场景中使用JSON Web Token是很有用的：</p><ul><li><p>Authorization (认证、授权) : 这是使用JWT的最常见场景。一旦用户登录，后续每个请求都将包含JWT，允许用户访问该令牌允许的路由、服务和资源。单点登录是现在广泛使用的JWT的一个特性，因为它的开销很小，并且可以轻松地跨域使用。</p></li><li><p>Information Exchange (信息交换) : 对于安全的在各方之间传输信息而言，JSON Web Tokens无疑是一种很好的方式。因为JWT可以被签名，例如，用公钥/私钥对，你可以确定发送人就是它们所说的那个人。另外，由于签名是使用头和有效负载计算的，您还可以验证内容没有被篡改。</p></li><li><p>基于Token的身份认证</p></li><li><p>基于服务器的身份认证</p></li></ul><h2 id=1-基于-token-的身份认证>1. 基于 Token 的身份认证</h2><p>在讨论基于Token的身份认证是如何工作的以及它的好处之前，我们先来看一下以前我们是怎么做的：</p><blockquote><p>HTTP 协议是无状态的，也就是说，如果我们已经认证了一个用户，那么他下一次请求的时候，服务器不知道我是谁，我们必须再次认证</p></blockquote><p>传统的做法是将已经认证过的用户信息存储在服务器上，比如Session。用户下次请求的时候带着Session ID，然后服务器以此检查用户是否认证过。</p><p>这种基于服务器的身份认证方式存在一些问题：</p><ul><li>Sessions : 每次用户认证通过以后，服务器需要创建一条记录保存用户信息，通常是在内存中，随着认证通过的用户越来越多，服务器的在这里的开销就会越来越大。</li><li>Scalability : 由于Session是在内存中的，这就带来一些扩展性的问题。</li><li>CORS : 当我们想要扩展我们的应用，让我们的数据被多个移动设备使用时，我们必须考虑跨资源共享问题。当使用AJAX调用从另一个域名下获取资源时，我们可能会遇到禁止请求的问题。</li><li>CSRF : 用户很容易受到CSRF攻击。</li></ul><p>5.2. JWT与Session的差异 相同点是，它们都是存储用户信息；然而，Session是在服务器端的，而JWT是在客户端的。</p><p>Session方式存储用户信息的最大问题在于要占用大量服务器内存，增加服务器的开销。</p><p>而JWT方式将用户状态分散到了客户端中，可以明显减轻服务端的内存压力。</p><p>Session的状态是存储在服务器端，客户端只有session id；而Token的状态是存储在客户端。</p><p><img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/v2-b7eeaf69feb5cbbadea7e0c73056da7a_1440w.webp alt=img></p><p>基于Token的身份认证是如何工作的 基于Token的身份认证是无状态的，服务器或者Session中不会存储任何用户信息。</p><p>没有会话信息意味着应用程序可以根据需要扩展和添加更多的机器，而不必担心用户登录的位置。</p><p>虽然这一实现可能会有所不同，但其主要流程如下：</p><p>-用户携带用户名和密码请求访问 -服务器校验用户凭据 -应用提供一个token给客户端 -客户端存储token，并且在随后的每一次请求中都带着它 -服务器校验token并返回数据</p><p>注意：</p><p>-每一次请求都需要token -Token应该放在请求header中 -我们还需要将服务器设置为接受来自所有域的请求，用Access-Control-Allow-Origin: *</p><p><img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/v2-7789057d5744891fdf3366d7887ab6e8_1440w.webp alt=img></p><p>5.4. 用Token的好处 - 无状态和可扩展性：Tokens存储在客户端。完全无状态，可扩展。我们的负载均衡器可以将用户传递到任意服务器，因为在任何地方都没有状态或会话信息。 - 安全：Token不是Cookie。（The token, not a cookie.）每次请求的时候Token都会被发送。而且，由于没有Cookie被发送，还有助于防止CSRF攻击。即使在你的实现中将token存储到客户端的Cookie中，这个Cookie也只是一种存储机制，而非身份认证机制。没有基于会话的信息可以操作，因为我们没有会话!</p><p>还有一点，token在一段时间以后会过期，这个时候用户需要重新登录。这有助于我们保持安全。还有一个概念叫token撤销，它允许我们根据相同的授权许可使特定的token甚至一组token无效。</p><p>5.5. JWT与OAuth的区别 -OAuth2是一种授权框架 ，JWT是一种认证协议 -无论使用哪种方式切记用HTTPS来保证数据的安全性 -OAuth2用在使用第三方账号登录的情况(比如使用weibo, qq, github登录某个app)，而JWT是用在前后端分离, 需要简单的对后台API进行保护时使用。</p><h2 id=2-基于服务器的身份认证>2. 基于服务器的身份认证</h2><p><img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/image-20240424133914569.png alt=image-20240424133914569></p><p><img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/image-20240424134647596.png alt=image-20240424134647596></p><blockquote><p>注意：</p><ol><li>服务器不能真正退出登录</li><li>用户信息修改后不能及时同步</li><li>Token 泄漏后没有有效的手段将 Token 置为无效</li></ol></blockquote><p>用户通过用户名和密码登录后，系统签发一个 JWT 给客户端，这个 Token 保存了一些用户的基本信息，以及权限相关的信息，后续用户请求的时候带上这个 Token ，服务器就知道当前访问的用户是谁、有哪些权限，而不用查询数据库去3获取用户的基本信息以及权限。</p><h2 id=3-密码重置和电子邮件验证>3. 密码重置和电子邮件验证</h2><p>服务器会生成包含用户信息的 JWT，并组成一个链接发到用户的邮箱，用户点击该链接后就可以重置密码或完成电子邮件验证（不是必须用 JWT）</p><h2 id=4-单点登录>4. 单点登录</h2><p><img src="https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0VzcGVjaWFsbHlfQWxsZW4=,size_16,color_FFFFFF,t_70.png" alt="JWT单点登录 看这一篇就够了！_c# jwt单点登录-CSDN博客"></p><p>#<img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/1533.png alt="JWT实现SSO单点登录的流程步骤 - 开发技术 - 亿速云"></p><h1 id=jws-json-web-signature>JWS （Json Web Signature）</h1><p>只对内容做签名，确保其不被篡改，但是其内容本身并没有被加密。（最常见的实现 JWT 实现方式）</p><p>它的头部和载荷都是没有加密的，所以它的目的并不是想隐藏数据，而是防止数据被篡改，这点是通过第三方签名来实现的</p><h1 id=jwejson-web-encryption>JWE（Json Web Encryption）</h1><p>会对内容本身加密，相对更安全，但是成本也会更高。</p><h1 id=对比sesion>对比sesion</h1><p><img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/9266406fb490f417a835b8b338913c9d.jpeg alt=jwt单点登录_手把手教你，使用JWT实现单点登录-CSDN博客></p><h1 id=对比-token>对比 Token</h1><p><img src=https://mielgo-markdown.oss-cn-chengdu.aliyuncs.com/024c30b33de98d05dc4521ba7cdd9bee.jpeg alt=img></p><hr><p>jwt就是个生成token（用户令牌）的一个规范。session id 也是一种用户令牌。
就是这个令牌里面带的用户信息，表名是哪个用户的令牌。
jwt里存的用户id，也可以存redis里。也可以不存。传统的session id 是在服务器存储服务中。
过期时间可以各种设计，可以在服务端存储，也可以带到jwt里。如果是带到jwt传里的，那某个用户的jwt串只能同时有一个生效，还是只要在没过过期时间内的都有效，这个要怎么控制。
有各种设计，本质上jwt就是个把用户id安全的传给客户端，客户端安全的传给服务端。</p><p>每个用户一个sha256哈希的密码，某个用户密码被破了，就改掉这个密码。 jwt和传统session(包括说的token)，唯一区别就是 服务端保存不保存这个token。然后是，jwt带的身份标识到了服务端后，需要获取权限。session的那个id 也可以存到redis里。redis key就是session的id，value就是鉴权信息。jwt的话，想要增加速度，鉴权信息得查出来后 也可以把鉴权的信息存储到redis里，那么问题来了，到底会不会节省服务器的内存？ 估计只会省掉存储身份id这个空间。
jwt还有个好处，就是服务器，redis炸了，session id的话就会丢失，jwt的话 还在。</p></section><nav class="mt-24 flex overflow-hidden rounded-xl bg-black/[3%] text-lg !leading-[1.2] *:flex *:w-1/2 *:items-center *:p-5 *:font-medium *:no-underline dark:bg-white/[8%] [&>*:hover]:bg-black/[2%] dark:[&>*:hover]:bg-white/[3%]"><a class="ltr:pr-3 rtl:pl-3" href=https://caoyang2002.xyz/post/2024/04/%E4%BB%80%E4%B9%88%E6%98%AF-simhash/><span class="ltr:mr-1.5 rtl:ml-1.5">←</span><span>什么是 SimHash</span></a>
<a class="ltr:ml-auto rtl:mr-auto justify-end pl-3" href=https://caoyang2002.xyz/post/2024/03/%E6%90%AD%E5%BB%BA-nps/><span>搭建 NPS</span><span class="ltr:ml-1.5 rtl:mr-1.5">→</span></a></nav><div class="mt-24 w-100rem" id=disqus_thread></div><script>const disqusShortname="caoyang2002.xyz",script=document.createElement("script");script.src="https://"+disqusShortname+".disqus.com/embed.js",script.setAttribute("data-timestamp",+new Date),document.head.appendChild(script)</script><div class="giscus mt-24"></div><script src=https://giscus.app/client.js data-repo=caoyang2002/caoyang2002 data-repo-id=R_kgDONgnnzg data-category=Announcements data-category-id=DIC_kwDONgnnzs4ClayH data-mapping=pathname data-strict=1 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><div class="hidden lg:block ml-8"><aside class="sticky top-24 w-64"><div class="not-prose sticky top-24 rounded-lg bg-white dark:bg-neutral-800 p-6 shadow-sm"><h3 class="mb-4 text-lg font-semibold bg-gradient-to-r from-neutral-800 to-neutral-600 dark:from-neutral-200 dark:to-neutral-400 bg-clip-text text-transparent">目录</h3><nav id=TableOfContents class=toc><nav id=TableOfContents><ul><li><a href=#一什么是-jwt>一、什么是 JWT</a></li><li><a href=#二设计目标>二、设计目标</a></li><li><a href=#三-json-web-token-的结构是什么样的>三、 JSON Web Token 的结构是什么样的</a><ul><li><a href=#1-header>1. Header</a></li><li><a href=#2-payload>2. Payload</a></li><li><a href=#3-signature>3. Signature</a></li></ul></li><li><a href=#jwt-是如何工作的>JWT 是如何工作的</a></li><li><a href=#三场景>三、场景</a><ul><li><a href=#1-基于-token-的身份认证>1. 基于 Token 的身份认证</a></li><li><a href=#2-基于服务器的身份认证>2. 基于服务器的身份认证</a></li><li><a href=#3-密码重置和电子邮件验证>3. 密码重置和电子邮件验证</a></li><li><a href=#4-单点登录>4. 单点登录</a></li></ul></li><li><a href=#jws-json-web-signature>JWS （Json Web Signature）</a></li><li><a href=#jwejson-web-encryption>JWE（Json Web Encryption）</a></li><li><a href=#对比sesion>对比sesion</a></li><li><a href=#对比-token>对比 Token</a></li></ul></nav></nav></div></aside><style>aside{position:fixed;top:96px;right:0;width:14rem;height:calc(100vh - 96px);overflow-y:auto;z-index:40}.toc-container{background:#fff;border-radius:.5rem;padding:.5rem;box-shadow:0 1px 3px rgb(0 0 0/.1)}@media(prefers-color-scheme:dark){.toc-container{background:#262626}}.toc{max-height:calc(100vh - 180px);overflow-y:auto;scrollbar-gutter:stable}.toc::-webkit-scrollbar{width:4px}.toc::-webkit-scrollbar-track{background:0 0}.toc::-webkit-scrollbar-thumb{background-color:#d1d1d1;border-radius:4px}.toc ul{list-style:none;padding-left:1rem}.toc li{margin:.5rem 0}.toc a{display:block;padding:.25rem .5rem;color:#4b5563;text-decoration:none;border-radius:.25rem;transition:all .2s}.toc a:hover{background-color:#f3f4f6;color:#111827}.toc a.active{background-color:#f3f4f6;color:#111827;font-weight:500}@media(max-width:768px){aside{display:none}}@media(prefers-color-scheme:dark){.toc a{color:#9ca3af}.toc a:hover,.toc a.active{background-color:#262626;color:#e5e7eb}.toc::-webkit-scrollbar-thumb{background-color:#404040}}h1,h2,h3,h4,h5,h6{scroll-margin-top:100px}</style><script>document.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target.getAttribute("id"),n=document.querySelector(`.toc a[href="#${t}"]`);e.intersectionRatio>0&&(document.querySelectorAll(".toc a.active").forEach(e=>{e.classList.remove("active")}),n?.classList.add("active"))})},{rootMargin:"-20% 0px -80% 0px"});document.querySelectorAll("h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]").forEach(t=>{e.observe(t)})});let touchStartX=0,touchEndX=0;document.addEventListener("touchstart",e=>{touchStartX=e.changedTouches[0].screenX},!1),document.addEventListener("touchend",e=>{touchEndX=e.changedTouches[0].screenX,handleSwipe()},!1);function handleSwipe(){const e=document.querySelector("aside"),t=touchEndX-touchStartX;Math.abs(t)>50&&(t<0?e?.classList.add("show"):e?.classList.remove("show"))}</script></div></div><footer class="flex items-center text-xs uppercase"><div class="mr-auto opacity-60">&copy; 2025
<a class=link href=https://caoyang2002.xyz/>caoyang2002</a></div><div><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>本站访问 <span id=busuanzi_value_page_pv><i class="fa fa-spinner fa-spin"></i></span> 次</div><a class="link mx-6 opacity-60" href=https://gohugo.io/ rel=noopener target=_blank>powered by hugo️️</a>️
<a class="link mx-6 opacity-60" href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>hugo-paper</a>
<a class="link opacity-60" href=https://github.com/caoyang2002/hugo-focus rel=noopener target=_blank>hugo-focus</a></footer><style>footer{position:fixed;bottom:0;left:0;right:0;z-index:50;width:100%;padding:.5rem;padding-bottom:calc(.5rem + var(--safe-padding-bottom));padding-left:max(.5rem,var(--safe-padding-left));padding-right:max(.5rem,var(--safe-padding-right));display:flex;justify-content:center;align-items:center;backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(12px);background:rgba(255,255,255,.85);border-top:1px solid rgba(255,255,255,.3);box-shadow:0 -4px 20px rgba(0,0,0,5%)}.dark footer{background:rgba(0,0,0,.85);border-top-color:rgba(255,255,255,.1)}.footer-content{width:100%;max-width:var(--w);margin:0 auto;padding:0 1rem;display:flex;flex-direction:row;align-items:center;justify-content:space-between;gap:1rem}.footer-element{padding:.75rem 1.5rem;font-size:.75rem;text-transform:uppercase;letter-spacing:.05em;opacity:.8;border-radius:.5rem;background:rgba(255,255,255,.1);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);transition:all .2s ease}.footer-element:hover{opacity:1;background:rgba(255,255,255,.2)}.dark .footer-element{background:rgba(255,255,255,5%)}.dark .footer-element:hover{background:rgba(255,255,255,.1)}@media(max-width:768px){footer{padding-top:.5rem;padding-bottom:calc(.5rem + env(safe-area-inset-bottom))}.footer-content{padding:0 .5rem;gap:.5rem}.footer-element{padding:.5rem 1rem;font-size:.75rem}}@media(min-width:768px){.footer-element{font-size:.875rem}}@media(min-width:1024px){.footer-content{padding:0 2rem;gap:2rem}.footer-element{padding:.75rem 2rem}}</style></body></html>