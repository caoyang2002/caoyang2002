<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>最佳实践 on 短松江月</title><link>https://simons.qzz.io/tags/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/</link><description>Recent content in 最佳实践 on 短松江月</description><generator>Hugo</generator><language>zh-CN</language><lastBuildDate>Fri, 30 Jan 2026 01:57:46 +0800</lastBuildDate><atom:link href="https://simons.qzz.io/tags/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/index.xml" rel="self" type="application/rss+xml"/><item><title>您需要了解的 14 个最重要的元和 HTML 标签</title><link>https://simons.qzz.io/post/2026/01/14_mos_-important_meta_and_html_tags_you_need_to_know_for_seo/</link><pubDate>Mon, 26 Jan 2026 14:19:26 +0800</pubDate><guid>https://simons.qzz.io/post/2026/01/14_mos_-important_meta_and_html_tags_you_need_to_know_for_seo/</guid><description>&lt;p&gt;使用有效的 Meta 和 HTML 标签提升您的 SEO。了解如何使用元标记优化您的网站以提高搜索引擎排名。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://www.searchenginejournal.com/wp-content/uploads/2020/07/important-meta-tags-5f203655f1aa8.jpg" alt="14 Most Important Meta And HTML Tags You Need To Know For SEO"&gt;&lt;/p&gt;
&lt;p&gt;很长一段时间以来，HTML 元标记一直被称为 



&lt;a href="https://www.searchenginejournal.com/seo/"
 
 
 target="_blank"
 rel="noopener noreferrer"
 class="external-link"
 data-preview-url="https://www.searchenginejournal.com/seo/"
 data-preview-type="external"
 &gt;
 SEO
 
 &lt;span class="external-icon"&gt;
 
 
 
 
 &lt;svg style="display:inline-block;width:0.85em;height:0.85em;vertical-align:middle;fill:currentColor" t="1769752196949" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2655" width="200" height="200"&gt;&lt;path d="M775.364451 0c94.991953 5.563939 180.631008 52.428422 224.93552 156.704272 45.055503 105.948832 24.985725 204.456746-52.700419 288.662818-54.989394 59.493344-114.038743 115.266729-171.791106 172.200101-25.087723 24.780727-65.229281 25.565718-86.971041 2.73097-21.981758-23.073746-19.592784-54.817396 6.825925-81.339103 56.661375-56.865373 114.140742-112.979754 170.188124-170.358122 84.479069-86.492046 46.966482-223.979531-69.734232-254.972189-48.571464-12.902858-95.162951-3.993956-132.094543 30.378665-59.391345 55.29539-115.266729 114.139742-174.419077 169.504131-12.526862 11.706871-33.279633 21.844759-49.527454 20.820771-43.51952-2.661971-65.501278-55.397389-35.39561-86.766044 64.716286-67.412257 130.728559-133.801525 200.223793-196.195836C647.160865 13.379852 702.285257 0.339996 775.364451 0zM0 760.891611c0.443995-72.703198 25.769716-135.575505 76.731154-187.389934 56.21638-57.274369 113.320751-113.662747 170.358122-170.187124 27.100701-26.896703 60.414334-28.909681 83.352081-5.801936 23.824737 24.029735 21.503763 54.373401-6.723926 82.738088-54.271402 54.476399-109.464793 108.235807-163.224201 163.326199-66.491267 67.924251-69.289236 159.708239-8.020911 221.31756 58.606354 58.94835 155.543285 59.221347 216.812609-0.442995 55.704386-54.271402 109.907788-110.181785 165.442176-164.555186 33.347632-32.63064 84.035073-20.991769 92.840977 22.902748 3.208965 15.769826-3.173965 39.594563-14.096845 51.131436-60.415334 63.624299-120.693669 127.793591-186.467944 185.512955-80.519112 70.689221-174.863072 82.431091-273.233987 39.594563C58.708353 957.599442 0.272997 864.246471 0 760.891611z m736.588879-414.715428c-3.514961 6.621927-7.576916 20.923769-16.724816 30.241667a52102.42255 52102.42255 0 0 1-333.820319 335.800298c-23.756738 23.722738-57.548366 22.118756-79.87112-0.443996-22.527752-22.731749-21.913758-53.929405 3.173965-79.119127C419.085379 522.644238 529.164166 412.905448 639.139953 303.270656c17.850803-17.783804 38.774572-25.258722 63.145304-14.711837 21.709761 9.420896 32.767639 26.691706 34.337621 57.650364z" p-id="2656"&gt;&lt;/path&gt;&lt;/svg&gt;
 
 &lt;/span&gt;
 
&lt;/a&gt;




&lt;template id="preview-template"&gt;
 &lt;div class="link-preview"&gt;
 &lt;div class="preview-loading"&gt;
 &lt;div class="loading-spinner"&gt;&lt;/div&gt;
 &lt;span&gt;加载中...&lt;/span&gt;
 &lt;/div&gt;
 &lt;div class="preview-content hidden"&gt;
 &lt;div class="preview-header"&gt;
 &lt;img class="preview-favicon" src="" alt=""&gt;
 &lt;div class="preview-title"&gt;&lt;/div&gt;
 &lt;button class="preview-close" aria-label="关闭"&gt;×&lt;/button&gt;
 &lt;/div&gt;
 &lt;div class="preview-body"&gt;
 &lt;div class="preview-image hidden"&gt;&lt;/div&gt;
 &lt;div class="preview-description"&gt;&lt;/div&gt;
 &lt;div class="preview-url"&gt;&lt;/div&gt;
 &lt;/div&gt;
 &lt;div class="preview-footer"&gt;
 &lt;a class="preview-link" href=""&gt;
 &lt;span&gt;访问链接 →&lt;/span&gt;
 &lt;/a&gt;
 &lt;/div&gt;
 &lt;/div&gt;
 &lt;/div&gt;
&lt;/template&gt;


&lt;style&gt;
 
 .external-link {
 color: #3b82f6;
 text-decoration: underline;
 text-decoration-color: rgba(59, 130, 246, 0.3);
 transition: text-decoration-color 0.2s;
 }

 .external-link:hover {
 text-decoration-color: rgba(59, 130, 246, 0.6);
 }

 .internal-link {
 color: #8b5cf6;
 text-decoration: underline;
 text-decoration-color: rgba(139, 92, 246, 0.3);
 transition: text-decoration-color 0.2s;
 }

 .internal-link:hover {
 text-decoration-color: rgba(139, 92, 246, 0.6);
 }

 .external-icon {
 display: inline-block;
 margin-left: 2px;
 opacity: 0.6;
 font-size: 0.9em;
 }

 
 .link-preview {
 position: fixed;
 z-index: 9999;
 width: 340px;
 max-width: calc(100vw - 32px);
 background: white;
 border-radius: 10px;
 box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12), 0 0 1px rgba(0, 0, 0, 0.1);
 border: 1px solid #e5e7eb;
 font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
 opacity: 0;
 transform: translateY(8px);
 transition: opacity 0.2s, transform 0.2s;
 pointer-events: none;
 overflow: hidden;
 }

 .link-preview.visible {
 opacity: 1;
 transform: translateY(0);
 pointer-events: auto;
 }

 .preview-header {
 display: flex;
 align-items: center;
 padding: 12px 14px;
 background: #f9fafb;
 border-bottom: 1px solid #e5e7eb;
 gap: 10px;
 }

 .preview-favicon {
 width: 16px;
 height: 16px;
 flex-shrink: 0;
 display: none;
 }

 .preview-favicon[src]:not([src=""]) {
 display: block;
 }

 .preview-title {
 flex: 1;
 font-weight: 600;
 font-size: 14px;
 color: #111827;
 white-space: nowrap;
 overflow: hidden;
 text-overflow: ellipsis;
 }

 .preview-close {
 background: transparent;
 border: none;
 font-size: 20px;
 cursor: pointer;
 color: #6b7280;
 line-height: 1;
 padding: 2px;
 width: 24px;
 height: 24px;
 display: flex;
 align-items: center;
 justify-content: center;
 border-radius: 4px;
 flex-shrink: 0;
 transition: all 0.15s;
 }

 .preview-close:hover {
 background: #e5e7eb;
 color: #111827;
 }

 .preview-body {
 max-height: 350px;
 overflow: hidden;
 }

 .preview-image {
 width: 100%;
 height: 180px;
 overflow: hidden;
 background: #f3f4f6;
 }

 .preview-image img {
 width: 100%;
 height: 100%;
 object-fit: cover;
 }

 .preview-image.hidden {
 display: none;
 }

 .preview-description {
 padding: 14px;
 font-size: 13px;
 line-height: 1.5;
 color: #4b5563;
 overflow: hidden;
 display: -webkit-box;
 -webkit-line-clamp: 4;
 -webkit-box-orient: vertical;
 }

 .preview-description:empty {
 display: none;
 }

 .preview-url {
 padding: 0 14px 10px;
 font-size: 12px;
 color: #9ca3af;
 white-space: nowrap;
 overflow: hidden;
 text-overflow: ellipsis;
 }

 .preview-footer {
 padding: 10px 14px;
 background: #f9fafb;
 border-top: 1px solid #e5e7eb;
 }

 .preview-link {
 display: inline-block;
 color: #3b82f6;
 text-decoration: none;
 font-size: 13px;
 font-weight: 500;
 transition: color 0.15s;
 }

 .preview-link:hover {
 color: #2563eb;
 text-decoration: underline;
 }

 .preview-loading {
 padding: 40px 20px;
 text-align: center;
 color: #6b7280;
 font-size: 13px;
 display: flex;
 flex-direction: column;
 align-items: center;
 gap: 10px;
 }

 .loading-spinner {
 width: 20px;
 height: 20px;
 border: 2px solid #e5e7eb;
 border-top-color: #3b82f6;
 border-radius: 50%;
 animation: spin 0.6s linear infinite;
 }

 @keyframes spin {
 to { transform: rotate(360deg); }
 }

 .hidden {
 display: none !important;
 }

 
 @media (prefers-color-scheme: dark) {
 .link-preview {
 background: #1f2937;
 border-color: #374151;
 }

 .preview-header,
 .preview-footer {
 background: #111827;
 border-color: #374151;
 }

 .preview-title {
 color: #f9fafb;
 }

 .preview-description {
 color: #d1d5db;
 }

 .preview-url {
 color: #6b7280;
 }

 .preview-close {
 color: #9ca3af;
 }

 .preview-close:hover {
 background: #374151;
 color: #f9fafb;
 }

 .preview-link {
 color: #60a5fa;
 }

 .preview-link:hover {
 color: #93c5fd;
 }

 .preview-image {
 background: #111827;
 }

 .loading-spinner {
 border-color: #374151;
 border-top-color: #60a5fa;
 }
 }
&lt;/style&gt;

&lt;script&gt;
(function() {
 'use strict';

 class LinkPreview {
 constructor() {
 this.preview = null;
 this.showTimer = null;
 this.hideTimer = null;
 this.currentUrl = null;
 this.cache = new Map();
 this.isOverLink = false;
 this.isOverPreview = false;
 this.init();
 }

 init() {
 
 if (window.linkPreviewInitialized) return;
 window.linkPreviewInitialized = true;

 const template = document.getElementById('preview-template');
 if (!template) return;

 this.preview = template.content.cloneNode(true).firstElementChild;
 document.body.appendChild(this.preview);

 this.bindEvents();
 }

 bindEvents() {
 
 document.addEventListener('mouseover', (e) =&gt; {
 const link = e.target.closest('a[data-preview-url]');
 if (link) this.handleLinkEnter(link);
 });

 document.addEventListener('mouseout', (e) =&gt; {
 const link = e.target.closest('a[data-preview-url]');
 if (link) this.handleLinkLeave();
 });

 
 this.preview.addEventListener('mouseenter', () =&gt; {
 this.isOverPreview = true;
 clearTimeout(this.hideTimer);
 });

 this.preview.addEventListener('mouseleave', () =&gt; {
 this.isOverPreview = false;
 this.scheduleHide();
 });

 
 this.preview.querySelector('.preview-close').addEventListener('click', () =&gt; {
 this.hide();
 });

 
 document.addEventListener('click', (e) =&gt; {
 if (!this.preview.contains(e.target)) {
 this.hide();
 }
 });

 
 document.addEventListener('keydown', (e) =&gt; {
 if (e.key === 'Escape') this.hide();
 });
 }

 handleLinkEnter(link) {
 this.isOverLink = true;
 clearTimeout(this.showTimer);
 clearTimeout(this.hideTimer);

 this.showTimer = setTimeout(() =&gt; {
 if (this.isOverLink) {
 this.show(link);
 }
 }, 300);
 }

 handleLinkLeave() {
 this.isOverLink = false;
 clearTimeout(this.showTimer);
 this.scheduleHide();
 }

 scheduleHide() {
 clearTimeout(this.hideTimer);
 this.hideTimer = setTimeout(() =&gt; {
 if (!this.isOverLink &amp;&amp; !this.isOverPreview) {
 this.hide();
 }
 }, 150);
 }

 async show(link) {
 const url = link.getAttribute('data-preview-url');
 const type = link.getAttribute('data-preview-type');

 if (!url) return;

 
 if (url === this.currentUrl &amp;&amp; this.preview.classList.contains('visible')) {
 this.position(link);
 return;
 }

 this.currentUrl = url;
 this.position(link);
 this.showLoading();

 try {
 const data = type === 'internal'
 ? await this.loadInternal(url)
 : this.loadExternal(url);

 this.render(data);
 } catch (err) {
 console.error('Preview error:', err);
 this.hide();
 }
 }

 position(link) {
 const rect = link.getBoundingClientRect();
 const width = 340;
 const margin = 10;

 let top = rect.bottom + window.scrollY + margin;
 let left = rect.left + window.scrollX;

 
 if (left + width &gt; window.innerWidth - margin) {
 left = window.innerWidth - width - margin;
 }
 if (left &lt; margin) {
 left = margin;
 }

 
 if (rect.bottom + 300 &gt; window.innerHeight) {
 top = rect.top + window.scrollY - 300 - margin;
 }

 this.preview.style.top = `${top}px`;
 this.preview.style.left = `${left}px`;
 this.preview.classList.add('visible');
 }

 async loadInternal(url) {
 
 if (this.cache.has(url)) {
 return this.cache.get(url);
 }

 try {
 const fullUrl = new URL(url, window.location.origin).href;
 const response = await fetch(fullUrl, {
 method: 'GET',
 headers: { 'Accept': 'text/html' }
 });

 if (!response.ok) throw new Error('Fetch failed');

 const html = await response.text();
 const parser = new DOMParser();
 const doc = parser.parseFromString(html, 'text/html');

 const data = {
 title: this.extractTitle(doc),
 description: this.extractDescription(doc),
 image: this.extractImage(doc, fullUrl),
 favicon: this.extractFavicon(doc, fullUrl),
 url: fullUrl
 };

 this.cache.set(url, data);
 return data;
 } catch (err) {
 throw err;
 }
 }

 loadExternal(url) {
 
 try {
 const urlObj = new URL(url);
 const hostname = urlObj.hostname;

 return {
 title: hostname,
 description: url,
 image: '',
 favicon: `https://www.google.com/s2/favicons?domain=${hostname}&amp;sz=32`,
 url: url
 };
 } catch (err) {
 return {
 title: '外部链接',
 description: url,
 image: '',
 favicon: '',
 url: url
 };
 }
 }

 extractTitle(doc) {
 return doc.querySelector('h1')?.textContent?.trim() ||
 doc.querySelector('meta[property="og:title"]')?.content ||
 doc.querySelector('title')?.textContent?.trim() ||
 '无标题';
 }

 extractDescription(doc) {
 const ogDesc = doc.querySelector('meta[property="og:description"]')?.content;
 const metaDesc = doc.querySelector('meta[name="description"]')?.content;
 const firstP = doc.querySelector('article p, main p, p')?.textContent?.trim();

 return ogDesc || metaDesc || (firstP ? firstP.substring(0, 200) : '');
 }

 extractImage(doc, baseUrl) {
 const ogImage = doc.querySelector('meta[property="og:image"]')?.content;
 const firstImg = doc.querySelector('article img, main img, img')?.src;

 const imgSrc = ogImage || firstImg;
 return imgSrc ? new URL(imgSrc, baseUrl).href : '';
 }

 extractFavicon(doc, baseUrl) {
 const iconLink = doc.querySelector('link[rel*="icon"]')?.href;
 return iconLink ? new URL(iconLink, baseUrl).href : '';
 }

 render(data) {
 this.preview.querySelector('.preview-loading').classList.add('hidden');
 const content = this.preview.querySelector('.preview-content');
 content.classList.remove('hidden');

 
 const favicon = this.preview.querySelector('.preview-favicon');
 if (data.favicon) {
 favicon.src = data.favicon;
 favicon.onerror = () =&gt; favicon.style.display = 'none';
 }

 this.preview.querySelector('.preview-title').textContent = data.title;
 this.preview.querySelector('.preview-description').textContent = data.description;
 this.preview.querySelector('.preview-url').textContent = data.url;

 const link = this.preview.querySelector('.preview-link');
 link.href = data.url;

 
 const imgContainer = this.preview.querySelector('.preview-image');
 if (data.image) {
 const img = document.createElement('img');
 img.src = data.image;
 img.alt = data.title;
 img.loading = 'lazy';
 img.onerror = () =&gt; imgContainer.classList.add('hidden');
 imgContainer.innerHTML = '';
 imgContainer.appendChild(img);
 imgContainer.classList.remove('hidden');
 } else {
 imgContainer.classList.add('hidden');
 }
 }

 showLoading() {
 this.preview.querySelector('.preview-content').classList.add('hidden');
 this.preview.querySelector('.preview-loading').classList.remove('hidden');
 }

 hide() {
 this.preview.classList.remove('visible');
 this.currentUrl = null;
 this.isOverPreview = false;
 this.isOverLink = false;
 clearTimeout(this.showTimer);
 clearTimeout(this.hideTimer);
 }
 }

 
 if (document.readyState === 'loading') {
 document.addEventListener('DOMContentLoaded', () =&gt; new LinkPreview());
 } else {
 new LinkPreview();
 }
})();
&lt;/script&gt;
 最重要的方面之一。你知道吗？这仍然是正确的。&lt;/p&gt;</description></item><item><title>【转载】如何做一个有质量的技术分享</title><link>https://simons.qzz.io/post/2025/02/how_to_make_a_quality_technology_sharing/</link><pubDate>Wed, 12 Feb 2025 09:28:36 +0800</pubDate><guid>https://simons.qzz.io/post/2025/02/how_to_make_a_quality_technology_sharing/</guid><description>&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;转载&lt;/strong&gt;
文章作者：左耳朵耗子
出处：



&lt;a href="https://coolshell.cn/"
 
 
 target="_blank"
 rel="noopener noreferrer"
 class="external-link"
 data-preview-url="https://coolshell.cn/"
 data-preview-type="external"
 &gt;
 酷 壳 – CoolShell
 
 &lt;span class="external-icon"&gt;
 
 
 
 
 &lt;svg style="display:inline-block;width:0.85em;height:0.85em;vertical-align:middle;fill:currentColor" t="1769752196949" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2655" width="200" height="200"&gt;&lt;path d="M775.364451 0c94.991953 5.563939 180.631008 52.428422 224.93552 156.704272 45.055503 105.948832 24.985725 204.456746-52.700419 288.662818-54.989394 59.493344-114.038743 115.266729-171.791106 172.200101-25.087723 24.780727-65.229281 25.565718-86.971041 2.73097-21.981758-23.073746-19.592784-54.817396 6.825925-81.339103 56.661375-56.865373 114.140742-112.979754 170.188124-170.358122 84.479069-86.492046 46.966482-223.979531-69.734232-254.972189-48.571464-12.902858-95.162951-3.993956-132.094543 30.378665-59.391345 55.29539-115.266729 114.139742-174.419077 169.504131-12.526862 11.706871-33.279633 21.844759-49.527454 20.820771-43.51952-2.661971-65.501278-55.397389-35.39561-86.766044 64.716286-67.412257 130.728559-133.801525 200.223793-196.195836C647.160865 13.379852 702.285257 0.339996 775.364451 0zM0 760.891611c0.443995-72.703198 25.769716-135.575505 76.731154-187.389934 56.21638-57.274369 113.320751-113.662747 170.358122-170.187124 27.100701-26.896703 60.414334-28.909681 83.352081-5.801936 23.824737 24.029735 21.503763 54.373401-6.723926 82.738088-54.271402 54.476399-109.464793 108.235807-163.224201 163.326199-66.491267 67.924251-69.289236 159.708239-8.020911 221.31756 58.606354 58.94835 155.543285 59.221347 216.812609-0.442995 55.704386-54.271402 109.907788-110.181785 165.442176-164.555186 33.347632-32.63064 84.035073-20.991769 92.840977 22.902748 3.208965 15.769826-3.173965 39.594563-14.096845 51.131436-60.415334 63.624299-120.693669 127.793591-186.467944 185.512955-80.519112 70.689221-174.863072 82.431091-273.233987 39.594563C58.708353 957.599442 0.272997 864.246471 0 760.891611z m736.588879-414.715428c-3.514961 6.621927-7.576916 20.923769-16.724816 30.241667a52102.42255 52102.42255 0 0 1-333.820319 335.800298c-23.756738 23.722738-57.548366 22.118756-79.87112-0.443996-22.527752-22.731749-21.913758-53.929405 3.173965-79.119127C419.085379 522.644238 529.164166 412.905448 639.139953 303.270656c17.850803-17.783804 38.774572-25.258722 63.145304-14.711837 21.709761 9.420896 32.767639 26.691706 34.337621 57.650364z" p-id="2656"&gt;&lt;/path&gt;&lt;/svg&gt;
 
 &lt;/span&gt;
 
&lt;/a&gt;




&lt;template id="preview-template"&gt;
 &lt;div class="link-preview"&gt;
 &lt;div class="preview-loading"&gt;
 &lt;div class="loading-spinner"&gt;&lt;/div&gt;
 &lt;span&gt;加载中...&lt;/span&gt;
 &lt;/div&gt;
 &lt;div class="preview-content hidden"&gt;
 &lt;div class="preview-header"&gt;
 &lt;img class="preview-favicon" src="" alt=""&gt;
 &lt;div class="preview-title"&gt;&lt;/div&gt;
 &lt;button class="preview-close" aria-label="关闭"&gt;×&lt;/button&gt;
 &lt;/div&gt;
 &lt;div class="preview-body"&gt;
 &lt;div class="preview-image hidden"&gt;&lt;/div&gt;
 &lt;div class="preview-description"&gt;&lt;/div&gt;
 &lt;div class="preview-url"&gt;&lt;/div&gt;
 &lt;/div&gt;
 &lt;div class="preview-footer"&gt;
 &lt;a class="preview-link" href=""&gt;
 &lt;span&gt;访问链接 →&lt;/span&gt;
 &lt;/a&gt;
 &lt;/div&gt;
 &lt;/div&gt;
 &lt;/div&gt;
&lt;/template&gt;


&lt;style&gt;
 
 .external-link {
 color: #3b82f6;
 text-decoration: underline;
 text-decoration-color: rgba(59, 130, 246, 0.3);
 transition: text-decoration-color 0.2s;
 }

 .external-link:hover {
 text-decoration-color: rgba(59, 130, 246, 0.6);
 }

 .internal-link {
 color: #8b5cf6;
 text-decoration: underline;
 text-decoration-color: rgba(139, 92, 246, 0.3);
 transition: text-decoration-color 0.2s;
 }

 .internal-link:hover {
 text-decoration-color: rgba(139, 92, 246, 0.6);
 }

 .external-icon {
 display: inline-block;
 margin-left: 2px;
 opacity: 0.6;
 font-size: 0.9em;
 }

 
 .link-preview {
 position: fixed;
 z-index: 9999;
 width: 340px;
 max-width: calc(100vw - 32px);
 background: white;
 border-radius: 10px;
 box-shadow: 0 10px 40px rgba(0, 0, 0, 0.12), 0 0 1px rgba(0, 0, 0, 0.1);
 border: 1px solid #e5e7eb;
 font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
 opacity: 0;
 transform: translateY(8px);
 transition: opacity 0.2s, transform 0.2s;
 pointer-events: none;
 overflow: hidden;
 }

 .link-preview.visible {
 opacity: 1;
 transform: translateY(0);
 pointer-events: auto;
 }

 .preview-header {
 display: flex;
 align-items: center;
 padding: 12px 14px;
 background: #f9fafb;
 border-bottom: 1px solid #e5e7eb;
 gap: 10px;
 }

 .preview-favicon {
 width: 16px;
 height: 16px;
 flex-shrink: 0;
 display: none;
 }

 .preview-favicon[src]:not([src=""]) {
 display: block;
 }

 .preview-title {
 flex: 1;
 font-weight: 600;
 font-size: 14px;
 color: #111827;
 white-space: nowrap;
 overflow: hidden;
 text-overflow: ellipsis;
 }

 .preview-close {
 background: transparent;
 border: none;
 font-size: 20px;
 cursor: pointer;
 color: #6b7280;
 line-height: 1;
 padding: 2px;
 width: 24px;
 height: 24px;
 display: flex;
 align-items: center;
 justify-content: center;
 border-radius: 4px;
 flex-shrink: 0;
 transition: all 0.15s;
 }

 .preview-close:hover {
 background: #e5e7eb;
 color: #111827;
 }

 .preview-body {
 max-height: 350px;
 overflow: hidden;
 }

 .preview-image {
 width: 100%;
 height: 180px;
 overflow: hidden;
 background: #f3f4f6;
 }

 .preview-image img {
 width: 100%;
 height: 100%;
 object-fit: cover;
 }

 .preview-image.hidden {
 display: none;
 }

 .preview-description {
 padding: 14px;
 font-size: 13px;
 line-height: 1.5;
 color: #4b5563;
 overflow: hidden;
 display: -webkit-box;
 -webkit-line-clamp: 4;
 -webkit-box-orient: vertical;
 }

 .preview-description:empty {
 display: none;
 }

 .preview-url {
 padding: 0 14px 10px;
 font-size: 12px;
 color: #9ca3af;
 white-space: nowrap;
 overflow: hidden;
 text-overflow: ellipsis;
 }

 .preview-footer {
 padding: 10px 14px;
 background: #f9fafb;
 border-top: 1px solid #e5e7eb;
 }

 .preview-link {
 display: inline-block;
 color: #3b82f6;
 text-decoration: none;
 font-size: 13px;
 font-weight: 500;
 transition: color 0.15s;
 }

 .preview-link:hover {
 color: #2563eb;
 text-decoration: underline;
 }

 .preview-loading {
 padding: 40px 20px;
 text-align: center;
 color: #6b7280;
 font-size: 13px;
 display: flex;
 flex-direction: column;
 align-items: center;
 gap: 10px;
 }

 .loading-spinner {
 width: 20px;
 height: 20px;
 border: 2px solid #e5e7eb;
 border-top-color: #3b82f6;
 border-radius: 50%;
 animation: spin 0.6s linear infinite;
 }

 @keyframes spin {
 to { transform: rotate(360deg); }
 }

 .hidden {
 display: none !important;
 }

 
 @media (prefers-color-scheme: dark) {
 .link-preview {
 background: #1f2937;
 border-color: #374151;
 }

 .preview-header,
 .preview-footer {
 background: #111827;
 border-color: #374151;
 }

 .preview-title {
 color: #f9fafb;
 }

 .preview-description {
 color: #d1d5db;
 }

 .preview-url {
 color: #6b7280;
 }

 .preview-close {
 color: #9ca3af;
 }

 .preview-close:hover {
 background: #374151;
 color: #f9fafb;
 }

 .preview-link {
 color: #60a5fa;
 }

 .preview-link:hover {
 color: #93c5fd;
 }

 .preview-image {
 background: #111827;
 }

 .loading-spinner {
 border-color: #374151;
 border-top-color: #60a5fa;
 }
 }
&lt;/style&gt;

&lt;script&gt;
(function() {
 'use strict';

 class LinkPreview {
 constructor() {
 this.preview = null;
 this.showTimer = null;
 this.hideTimer = null;
 this.currentUrl = null;
 this.cache = new Map();
 this.isOverLink = false;
 this.isOverPreview = false;
 this.init();
 }

 init() {
 
 if (window.linkPreviewInitialized) return;
 window.linkPreviewInitialized = true;

 const template = document.getElementById('preview-template');
 if (!template) return;

 this.preview = template.content.cloneNode(true).firstElementChild;
 document.body.appendChild(this.preview);

 this.bindEvents();
 }

 bindEvents() {
 
 document.addEventListener('mouseover', (e) =&gt; {
 const link = e.target.closest('a[data-preview-url]');
 if (link) this.handleLinkEnter(link);
 });

 document.addEventListener('mouseout', (e) =&gt; {
 const link = e.target.closest('a[data-preview-url]');
 if (link) this.handleLinkLeave();
 });

 
 this.preview.addEventListener('mouseenter', () =&gt; {
 this.isOverPreview = true;
 clearTimeout(this.hideTimer);
 });

 this.preview.addEventListener('mouseleave', () =&gt; {
 this.isOverPreview = false;
 this.scheduleHide();
 });

 
 this.preview.querySelector('.preview-close').addEventListener('click', () =&gt; {
 this.hide();
 });

 
 document.addEventListener('click', (e) =&gt; {
 if (!this.preview.contains(e.target)) {
 this.hide();
 }
 });

 
 document.addEventListener('keydown', (e) =&gt; {
 if (e.key === 'Escape') this.hide();
 });
 }

 handleLinkEnter(link) {
 this.isOverLink = true;
 clearTimeout(this.showTimer);
 clearTimeout(this.hideTimer);

 this.showTimer = setTimeout(() =&gt; {
 if (this.isOverLink) {
 this.show(link);
 }
 }, 300);
 }

 handleLinkLeave() {
 this.isOverLink = false;
 clearTimeout(this.showTimer);
 this.scheduleHide();
 }

 scheduleHide() {
 clearTimeout(this.hideTimer);
 this.hideTimer = setTimeout(() =&gt; {
 if (!this.isOverLink &amp;&amp; !this.isOverPreview) {
 this.hide();
 }
 }, 150);
 }

 async show(link) {
 const url = link.getAttribute('data-preview-url');
 const type = link.getAttribute('data-preview-type');

 if (!url) return;

 
 if (url === this.currentUrl &amp;&amp; this.preview.classList.contains('visible')) {
 this.position(link);
 return;
 }

 this.currentUrl = url;
 this.position(link);
 this.showLoading();

 try {
 const data = type === 'internal'
 ? await this.loadInternal(url)
 : this.loadExternal(url);

 this.render(data);
 } catch (err) {
 console.error('Preview error:', err);
 this.hide();
 }
 }

 position(link) {
 const rect = link.getBoundingClientRect();
 const width = 340;
 const margin = 10;

 let top = rect.bottom + window.scrollY + margin;
 let left = rect.left + window.scrollX;

 
 if (left + width &gt; window.innerWidth - margin) {
 left = window.innerWidth - width - margin;
 }
 if (left &lt; margin) {
 left = margin;
 }

 
 if (rect.bottom + 300 &gt; window.innerHeight) {
 top = rect.top + window.scrollY - 300 - margin;
 }

 this.preview.style.top = `${top}px`;
 this.preview.style.left = `${left}px`;
 this.preview.classList.add('visible');
 }

 async loadInternal(url) {
 
 if (this.cache.has(url)) {
 return this.cache.get(url);
 }

 try {
 const fullUrl = new URL(url, window.location.origin).href;
 const response = await fetch(fullUrl, {
 method: 'GET',
 headers: { 'Accept': 'text/html' }
 });

 if (!response.ok) throw new Error('Fetch failed');

 const html = await response.text();
 const parser = new DOMParser();
 const doc = parser.parseFromString(html, 'text/html');

 const data = {
 title: this.extractTitle(doc),
 description: this.extractDescription(doc),
 image: this.extractImage(doc, fullUrl),
 favicon: this.extractFavicon(doc, fullUrl),
 url: fullUrl
 };

 this.cache.set(url, data);
 return data;
 } catch (err) {
 throw err;
 }
 }

 loadExternal(url) {
 
 try {
 const urlObj = new URL(url);
 const hostname = urlObj.hostname;

 return {
 title: hostname,
 description: url,
 image: '',
 favicon: `https://www.google.com/s2/favicons?domain=${hostname}&amp;sz=32`,
 url: url
 };
 } catch (err) {
 return {
 title: '外部链接',
 description: url,
 image: '',
 favicon: '',
 url: url
 };
 }
 }

 extractTitle(doc) {
 return doc.querySelector('h1')?.textContent?.trim() ||
 doc.querySelector('meta[property="og:title"]')?.content ||
 doc.querySelector('title')?.textContent?.trim() ||
 '无标题';
 }

 extractDescription(doc) {
 const ogDesc = doc.querySelector('meta[property="og:description"]')?.content;
 const metaDesc = doc.querySelector('meta[name="description"]')?.content;
 const firstP = doc.querySelector('article p, main p, p')?.textContent?.trim();

 return ogDesc || metaDesc || (firstP ? firstP.substring(0, 200) : '');
 }

 extractImage(doc, baseUrl) {
 const ogImage = doc.querySelector('meta[property="og:image"]')?.content;
 const firstImg = doc.querySelector('article img, main img, img')?.src;

 const imgSrc = ogImage || firstImg;
 return imgSrc ? new URL(imgSrc, baseUrl).href : '';
 }

 extractFavicon(doc, baseUrl) {
 const iconLink = doc.querySelector('link[rel*="icon"]')?.href;
 return iconLink ? new URL(iconLink, baseUrl).href : '';
 }

 render(data) {
 this.preview.querySelector('.preview-loading').classList.add('hidden');
 const content = this.preview.querySelector('.preview-content');
 content.classList.remove('hidden');

 
 const favicon = this.preview.querySelector('.preview-favicon');
 if (data.favicon) {
 favicon.src = data.favicon;
 favicon.onerror = () =&gt; favicon.style.display = 'none';
 }

 this.preview.querySelector('.preview-title').textContent = data.title;
 this.preview.querySelector('.preview-description').textContent = data.description;
 this.preview.querySelector('.preview-url').textContent = data.url;

 const link = this.preview.querySelector('.preview-link');
 link.href = data.url;

 
 const imgContainer = this.preview.querySelector('.preview-image');
 if (data.image) {
 const img = document.createElement('img');
 img.src = data.image;
 img.alt = data.title;
 img.loading = 'lazy';
 img.onerror = () =&gt; imgContainer.classList.add('hidden');
 imgContainer.innerHTML = '';
 imgContainer.appendChild(img);
 imgContainer.classList.remove('hidden');
 } else {
 imgContainer.classList.add('hidden');
 }
 }

 showLoading() {
 this.preview.querySelector('.preview-content').classList.add('hidden');
 this.preview.querySelector('.preview-loading').classList.remove('hidden');
 }

 hide() {
 this.preview.classList.remove('visible');
 this.currentUrl = null;
 this.isOverPreview = false;
 this.isOverLink = false;
 clearTimeout(this.showTimer);
 clearTimeout(this.hideTimer);
 }
 }

 
 if (document.readyState === 'loading') {
 document.addEventListener('DOMContentLoaded', () =&gt; new LinkPreview());
 } else {
 new LinkPreview();
 }
})();
&lt;/script&gt;

非商用&lt;/p&gt;</description></item><item><title>GitHub Projects深入剖析：不只是看板，是工程管理的操作系统</title><link>https://simons.qzz.io/post/2025/01/in-depth_analysis_of_github_projects_its_not_just_kanban_its_the_operating_system_for_project_management/</link><pubDate>Sun, 26 Jan 2025 10:48:35 +0800</pubDate><guid>https://simons.qzz.io/post/2025/01/in-depth_analysis_of_github_projects_its_not_just_kanban_its_the_operating_system_for_project_management/</guid><description>&lt;h1 id="github-projects深入剖析不只是看板是工程管理的操作系统"&gt;GitHub Projects深入剖析：不只是看板，是工程管理的操作系统&lt;/h1&gt;
&lt;p&gt;先说个真实场景：一个十几人的团队，用GitHub管理代码，但项目进度全靠口头同步。最后结果可想而知: 一团糟。&lt;/p&gt;
&lt;h2 id="本质分析"&gt;本质分析&lt;/h2&gt;
&lt;p&gt;GitHub Projects不是简单的任务管理工具，而是一个完整的工程管理系统。它把Issues、PR、代码、里程碑等所有开发要素关联起来。&lt;/p&gt;</description></item><item><title>Rust 中的引用</title><link>https://simons.qzz.io/post/2025/01/rust_ref/</link><pubDate>Wed, 15 Jan 2025 11:57:02 +0800</pubDate><guid>https://simons.qzz.io/post/2025/01/rust_ref/</guid><description>&lt;h1 id="引用你的快递地址和包裹"&gt;引用：你的快递地址和包裹&lt;/h1&gt;
&lt;p&gt;想象这样一个场景：你在网上买了个漂亮的花瓶，快递公司需要把它送到你家。快递员需要知道两个信息：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;你家的地址（引用）&lt;/li&gt;
&lt;li&gt;花瓶本身（值）&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="为什么我们需要引用"&gt;为什么我们需要引用？&lt;/h2&gt;
&lt;p&gt;让我们看一个具体的问题：&lt;/p&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="rust"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-rust"&gt;fn calculate_length(s: String) -&amp;gt; usize {
 s.len()
}

let s = String::from(&amp;#34;hello&amp;#34;);
let len = calculate_length(s);
println!(&amp;#34;{}&amp;#34;, s); // 编译错误！s 已经被转移了所有权&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;p&gt;这就像你把花瓶（值）直接给了快递员（函数），花瓶就不再属于你了。但很多时候，我们只是想让快递员看看花瓶，而不是把它拿走。&lt;/p&gt;</description></item><item><title>Rust 函数式编程</title><link>https://simons.qzz.io/post/2025/01/rust_programming/</link><pubDate>Wed, 15 Jan 2025 11:48:53 +0800</pubDate><guid>https://simons.qzz.io/post/2025/01/rust_programming/</guid><description>&lt;p&gt;让我用这种方式来讲解 Rust 的函数式编程概念：&lt;/p&gt;
&lt;h1 id="引入问题"&gt;引入问题&lt;/h1&gt;
&lt;p&gt;想象这样一个场景：你需要处理一个电商系统的订单数据。要求：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;过滤出金额大于 100 的订单&lt;/li&gt;
&lt;li&gt;计算这些订单的总金额&lt;/li&gt;
&lt;li&gt;给每个订单加上 10% 的折扣&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;传统的命令式编程可能是这样：&lt;/p&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="rust"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-rust"&gt;let mut total = 0;
for order in orders {
 if order.amount &amp;gt; 100 {
 total &amp;#43;= order.amount * 0.9;
 }
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;p&gt;这段代码有什么问题？&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;可读性不高：逻辑分散在循环中&lt;/li&gt;
&lt;li&gt;难以修改：如果要改变处理逻辑，需要修改循环内部&lt;/li&gt;
&lt;li&gt;难以复用：这段逻辑很难在其他地方重用&lt;/li&gt;
&lt;li&gt;易出错：可变状态(total)增加了出错风险&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="问题模型"&gt;问题模型&lt;/h1&gt;
&lt;p&gt;我们需要一种方式能够：&lt;/p&gt;</description></item><item><title>Wasm 打印输出和浏览器特性等最佳实践</title><link>https://simons.qzz.io/post/2025/01/wasm_print/</link><pubDate>Wed, 15 Jan 2025 00:31:17 +0800</pubDate><guid>https://simons.qzz.io/post/2025/01/wasm_print/</guid><description>&lt;p&gt;在 Rust WASM 中，有几种方式可以实现打印输出和调用浏览器特性：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;使用 &lt;code&gt;web_sys&lt;/code&gt; 和 &lt;code&gt;wasm_bindgen&lt;/code&gt; 进行浏览器 API 调用：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="rust"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-rust"&gt;use wasm_bindgen::prelude::*;
use web_sys::{console, window};

pub fn move_test(name: &amp;amp;str) {
 // 控制台打印
 console::log_1(&amp;amp;JsValue::from_str(&amp;amp;format!(&amp;#34;move test: {}&amp;#34;, name)));

 // 使用 console.warn
 console::warn_1(&amp;amp;JsValue::from_str(&amp;#34;This is a warning&amp;#34;));

 // 使用 console.error
 console::error_1(&amp;amp;JsValue::from_str(&amp;#34;This is an error&amp;#34;));

 // 浏览器 alert
 if let Some(window) = window() {
 window
 .alert_with_message(&amp;amp;format!(&amp;#34;Hello, {}!&amp;#34;, name))
 .expect(&amp;#34;alert failed&amp;#34;);
 }

 // 确认对话框
 if let Some(window) = window() {
 if window
 .confirm_with_message(&amp;#34;Do you want to continue?&amp;#34;)
 .expect(&amp;#34;confirm failed&amp;#34;)
 {
 console::log_1(&amp;amp;JsValue::from_str(&amp;#34;User clicked OK&amp;#34;));
 } else {
 console::log_1(&amp;amp;JsValue::from_str(&amp;#34;User clicked Cancel&amp;#34;));
 }
 }
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="2"&gt;
&lt;li&gt;在 Cargo.toml 中需要添加必要的依赖：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div&gt;
 &lt;pre&gt;&lt;code class="language-toml" data-lang="toml"&gt;[dependencies]
wasm-bindgen = &amp;#34;0.2&amp;#34;
web-sys = { version = &amp;#34;0.3&amp;#34;, features = [
 &amp;#34;console&amp;#34;,
 &amp;#34;Window&amp;#34;,
 &amp;#34;Document&amp;#34;,
 &amp;#34;Element&amp;#34;,
 &amp;#34;HtmlElement&amp;#34;,
 &amp;#34;Node&amp;#34;,
 &amp;#34;Location&amp;#34;
]}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ol start="3"&gt;
&lt;li&gt;如果需要格式化打印，可以使用 &lt;code&gt;console::log!&lt;/code&gt; 宏：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="rust"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-rust"&gt;use web_sys::console;

// 需要引入宏
#[macro_export]
macro_rules! console_log {
 ($($t:tt)*) =&amp;gt; (console::log_1(&amp;amp;JsValue::from_str(&amp;amp;format!($($t)*))))
}

pub fn move_test(name: &amp;amp;str) {
 console_log!(&amp;#34;Testing move with name: {}&amp;#34;, name);
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="4"&gt;
&lt;li&gt;操作 DOM 示例：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="rust"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-rust"&gt;use wasm_bindgen::prelude::*;
use web_sys::{Document, Element, HtmlElement, window};

pub fn move_test(name: &amp;amp;str) {
 // 获取 document
 let window = window().expect(&amp;#34;no global window exists&amp;#34;);
 let document = window.document().expect(&amp;#34;no document exists&amp;#34;);

 // 创建新元素
 if let Some(div) = document.get_element_by_id(&amp;#34;test-input&amp;#34;) {
 // 修改输入框的值
 if let Some(input) = div.dyn_ref::&amp;lt;HtmlElement&amp;gt;() {
 input.set_inner_text(&amp;amp;format!(&amp;#34;New value: {}&amp;#34;, name));
 }
 }

 // 创建新元素
 let new_div = document.create_element(&amp;#34;div&amp;#34;).unwrap();
 new_div.set_text_content(Some(&amp;amp;format!(&amp;#34;Hello {}&amp;#34;, name)));

 // 添加到 body
 if let Some(body) = document.body() {
 body.append_child(&amp;amp;new_div).unwrap();
 }
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="5"&gt;
&lt;li&gt;处理错误和 Result：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="rust"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-rust"&gt;pub fn move_test(name: &amp;amp;str) -&amp;gt; Result&amp;lt;(), JsValue&amp;gt; {
 // 使用 ? 运算符处理错误
 let window = window().ok_or(&amp;#34;no global window exists&amp;#34;)?;
 let document = window.document().ok_or(&amp;#34;no document exists&amp;#34;)?;

 // 处理可能的错误
 match document.get_element_by_id(&amp;#34;test-input&amp;#34;) {
 Some(element) =&amp;gt; {
 console::log_1(&amp;amp;JsValue::from_str(&amp;amp;format!(&amp;#34;Found element: {}&amp;#34;, name)));
 Ok(())
 },
 None =&amp;gt; Err(JsValue::from_str(&amp;#34;Element not found&amp;#34;))
 }
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="6"&gt;
&lt;li&gt;使用本地存储：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="rust"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-rust"&gt;use web_sys::Storage;

pub fn move_test(name: &amp;amp;str) -&amp;gt; Result&amp;lt;(), JsValue&amp;gt; {
 let window = window().ok_or(&amp;#34;no global window exists&amp;#34;)?;

 // 获取 localStorage
 if let Some(storage) = window.local_storage()? {
 // 存储数据
 storage.set_item(&amp;#34;user_name&amp;#34;, name)?;

 // 读取数据
 if let Ok(Some(saved_name)) = storage.get_item(&amp;#34;user_name&amp;#34;) {
 console::log_1(&amp;amp;JsValue::from_str(&amp;amp;format!(&amp;#34;Saved name: {}&amp;#34;, saved_name)));
 }
 }

 Ok(())
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;p&gt;记住在使用任何 web-sys 功能时，需要在 Cargo.toml 中启用相应的 feature。例如，如果要使用 localStorage，需要添加 &amp;ldquo;Storage&amp;rdquo; feature：&lt;/p&gt;</description></item><item><title>Go 最佳实践</title><link>https://simons.qzz.io/post/2024/12/go/</link><pubDate>Sun, 29 Dec 2024 09:31:37 +0800</pubDate><guid>https://simons.qzz.io/post/2024/12/go/</guid><description>&lt;p&gt;在 Go 项目架构中，有一些重要的设计原则和规则。我来详细说明：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;接口定义规则：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="go"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-go"&gt;// ✅ 正确：接口定义在使用方(调用方)包中
package handler
type UserService interface {
 Create(ctx context.Context, user *User) error
}

// ❌ 错误：接口定义在实现方包中
package service
type UserService interface {
 Create(ctx context.Context, user *User) error
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="2"&gt;
&lt;li&gt;依赖方向：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="go"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-go"&gt;// ✅ 正确的依赖方向
handler -&amp;gt; service -&amp;gt; repository -&amp;gt; database

// ❌ 错误：不应该出现反向依赖
service -&amp;gt; handler
repository -&amp;gt; service&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="3"&gt;
&lt;li&gt;数据模型定义：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="go"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-go"&gt;// ✅ 正确：每层使用自己的数据模型
package handler
type CreateUserRequest struct { // API层模型
 Username string `json:&amp;#34;username&amp;#34;`
}

package service
type UserDTO struct { // 业务层模型
 ID uint64
 Username string
}

package repository
type UserDO struct { // 数据层模型
 ID uint64 `gorm:&amp;#34;primaryKey&amp;#34;`
 Username string
 CreatedAt time.Time
}

// ❌ 错误：直接在所有层使用相同的模型
type User struct {
 ID uint64 `json:&amp;#34;id&amp;#34; gorm:&amp;#34;primaryKey&amp;#34;`
 Username string `json:&amp;#34;username&amp;#34;`
 CreatedAt time.Time `json:&amp;#34;created_at&amp;#34;`
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="4"&gt;
&lt;li&gt;错误处理层级：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="go"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-go"&gt;// ✅ 正确：每层对错误进行适当包装
package repository
func (r *UserRepo) Create(user *UserDO) error {
 return fmt.Errorf(&amp;#34;database error: %w&amp;#34;, err)
}

package service
func (s *UserService) Create(user *UserDTO) error {
 return fmt.Errorf(&amp;#34;business error: %w&amp;#34;, err)
}

package handler
func (h *UserHandler) Create(c *gin.Context) {
 if err := h.service.Create(user); err != nil {
 c.JSON(getErrorStatus(err), ErrorResponse{err.Error()})
 return
 }
}

// ❌ 错误：直接暴露底层错误
if err := db.Create(&amp;amp;user).Error; err != nil {
 c.JSON(500, err.Error())
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="5"&gt;
&lt;li&gt;包的组织：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div&gt;
 &lt;pre&gt;&lt;code class="language-" data-lang=""&gt;✅ 正确的包组织：
project/
 ├── api/
 │ └── handler/ # HTTP 处理层
 ├── internal/
 │ ├── service/ # 业务逻辑层
 │ ├── repository/ # 数据访问层
 │ └── model/ # 内部数据模型
 ├── pkg/
 │ └── util/ # 公共工具函数
 └── main.go

❌ 错误的包组织：
project/
 ├── handlers/
 ├── services/
 ├── models/
 └── main.go&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;ol start="6"&gt;
&lt;li&gt;依赖注入：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="go"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-go"&gt;// ✅ 正确：通过构造函数注入依赖
func NewUserHandler(service UserService) *UserHandler {
 return &amp;amp;UserHandler{service: service}
}

// ❌ 错误：全局变量或直接初始化
var userService = &amp;amp;UserService{}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="7"&gt;
&lt;li&gt;接口隔离：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="go"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-go"&gt;// ✅ 正确：小接口，职责单一
type UserReader interface {
 GetUser(id uint64) (*User, error)
}

type UserWriter interface {
 CreateUser(user *User) error
}

// ❌ 错误：大接口，职责过多
type UserService interface {
 GetUser(id uint64) (*User, error)
 CreateUser(user *User) error
 UpdateUser(user *User) error
 DeleteUser(id uint64) error
 ListUsers() ([]*User, error)
 SearchUsers(query string) ([]*User, error)
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="8"&gt;
&lt;li&gt;配置管理：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="go"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-go"&gt;// ✅ 正确：集中管理配置
package config

type Config struct {
 Server ServerConfig
 DB DatabaseConfig
 Redis RedisConfig
}

// ❌ 错误：分散的配置或硬编码
var serverPort = 8080
var dbConnection = &amp;#34;root:password@tcp(localhost:3306)/db&amp;#34;&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="9"&gt;
&lt;li&gt;上下文传递：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="go"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-go"&gt;// ✅ 正确：统一使用 context 传递请求上下文
func (h *Handler) Create(c *gin.Context) {
 ctx := c.Request.Context()
 err := h.service.Create(ctx, req)
}

// ❌ 错误：不传递上下文或使用不一致的上下文
func (h *Handler) Create(c *gin.Context) {
 err := h.service.Create(req)
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;ol start="10"&gt;
&lt;li&gt;测试组织：&lt;/li&gt;
&lt;/ol&gt;










 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 



 





&lt;div class="code-playground" data-language="go"&gt;
 
 &lt;div&gt;
 &lt;pre&gt;&lt;code class="language-go"&gt;// ✅ 正确：测试文件与源文件对应
package handler

func TestUserHandler_Create(t *testing.T) {
 // 单元测试
}

// ❌ 错误：测试代码与源码混合或测试覆盖不全
func TestAll(t *testing.T) {
 // 混合测试多个功能
}&lt;/code&gt;&lt;/pre&gt;
 &lt;/div&gt;

 
 
&lt;/div&gt;

&lt;p&gt;遵循这些规则可以使代码：&lt;/p&gt;</description></item></channel></rss>